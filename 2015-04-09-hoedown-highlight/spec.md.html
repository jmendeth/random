<!doctype html>
<html>
<head><meta charset="utf-8">
  <title>Markdown</title>
  <link href="styles.css" rel="stylesheet" />
</head>
<body>
  <pre id="markdown">
<span class="atx header"># <span class="content"><span class="html">&lt;a id=&quot;introduction&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 1 Introduction</span></span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;what-is-markdown-&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 1.1 What is Markdown?</span></span>
</span>
<span class="paragraph"><span class="string">Markdown is a plain text format for writing structured documents,
based on conventions used for indicating formatting in email and
usenet posts.  It was developed in 2004 by John Gruber, who wrote
the first Markdown-to-HTML converter in perl, and it soon became
widely used in websites.  By 2014 there were dozens of
implementations in many languages.  Some of them extended basic
Markdown syntax with conventions for footnotes, definition lists,
tables, and other constructs, and some allowed output not just in
HTML but in LaTeX and many other formats.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;why-is-a-spec-needed-&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 1.2 Why is a spec needed?</span></span>
</span>
<span class="paragraph"><span class="string">John Gruber's </span><span class="link">[<span class="string">canonical description of Markdown's
syntax</span>](<span class="destination">http://daringfireball.net/projects/markdown/syntax</span>)</span><span class="string">
does not specify the syntax unambiguously.  Here are some examples of
questions it does not answer:</span>
</span>
<span class="list"><span class="list item">1.  <span class="content"><span class="paragraph"><span class="string">How much indentation is needed for a sublist?  The spec says that
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">continuation paragraphs need to be indented four spaces, but is
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">not fully explicit about sublists.  It is natural to think that
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">they, too, must be indented four spaces, but </span><span class="code">`Markdown.pl`</span><span class="string"> does
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">not require that.  This is hardly a &quot;corner case,&quot; and divergences
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">between implementations on this issue often lead to surprises for
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">users in real documents. (See </span><span class="link">[<span class="string">this comment by John
</span></span></span></span>    <span class="content"><span class="paragraph"><span class="link"><span class="string">Gruber</span>](<span class="destination">http://article.gmane.org/gmane.text.markdown.general/1997</span>)</span><span class="string">.)</span>
</span></span>
</span><span class="list item">2.  <span class="content"><span class="paragraph"><span class="string">Is a blank line needed before a block quote or header?
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">Most implementations do not require the blank line.  However,
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">this can lead to unexpected results in hard-wrapped text, and
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">also to ambiguities in parsing (note that some implementations
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">put the header inside the blockquote, while others do not).
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">(John Gruber has also spoken </span><span class="link">[<span class="string">in favor of requiring the blank
</span></span></span></span>    <span class="content"><span class="paragraph"><span class="link"><span class="string">lines</span>](<span class="destination">http://article.gmane.org/gmane.text.markdown.general/2146</span>)</span><span class="string">.)</span>
</span></span>
</span><span class="list item">3.  <span class="content"><span class="paragraph"><span class="string">Is a blank line needed before an indented code block?
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">(</span><span class="code">`Markdown.pl`</span><span class="string"> requires it, but this is not mentioned in the
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">documentation, and some implementations do not require it.)</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">paragraph
</span></span>    <span class="content"><span class="fenced code block">    code?
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">4.  <span class="content"><span class="paragraph"><span class="string">What is the exact rule for determining when list items get
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">wrapped in </span><span class="code">`&lt;p&gt;`</span><span class="string"> tags?  Can a list be partially &quot;loose&quot; and partially
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">&quot;tight&quot;?  What should we do with a list like this?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">1. one
</span></span><span class="content"><span class="fenced code block">
</span></span>    <span class="content"><span class="fenced code block">2. two
</span></span>    <span class="content"><span class="fenced code block">3. three
</span></span>    <span class="content"><span class="fenced code block">```
</span></span><span class="content">
</span>    <span class="content"><span class="paragraph"><span class="string">Or this?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">1.  one
</span></span>    <span class="content"><span class="fenced code block">    - a
</span></span><span class="content"><span class="fenced code block">
</span></span>    <span class="content"><span class="fenced code block">    - b
</span></span>    <span class="content"><span class="fenced code block">2.  two
</span></span>    <span class="content"><span class="fenced code block">```
</span></span><span class="content">
</span>    <span class="content"><span class="paragraph"><span class="string">(There are some relevant comments by John Gruber
</span></span></span>    <span class="content"><span class="paragraph"><span class="link">[<span class="string">here</span>](<span class="destination">http://article.gmane.org/gmane.text.markdown.general/2554</span>)</span><span class="string">.)</span>
</span></span>
</span><span class="list item">5.  <span class="content"><span class="paragraph"><span class="string">Can list markers be indented?  Can ordered list markers be right-aligned?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block"> 8. item 1
</span></span>    <span class="content"><span class="fenced code block"> 9. item 2
</span></span>    <span class="content"><span class="fenced code block">10. item 2a
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">6.  <span class="content"><span class="paragraph"><span class="string">Is this one list with a horizontal rule in its second item,
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">or two lists separated by a horizontal rule?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">* a
</span></span>    <span class="content"><span class="fenced code block">* * * * *
</span></span>    <span class="content"><span class="fenced code block">* b
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">7.  <span class="content"><span class="paragraph"><span class="string">When list markers change from numbers to bullets, do we have
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">two lists or one?  (The Markdown syntax description suggests two,
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">but the perl scripts and many other implementations produce one.)</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">1. fee
</span></span>    <span class="content"><span class="fenced code block">2. fie
</span></span>    <span class="content"><span class="fenced code block">-  foe
</span></span>    <span class="content"><span class="fenced code block">-  fum
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">8.  <span class="content"><span class="paragraph"><span class="string">What are the precedence rules for the markers of inline structure?
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">For example, is the following a valid link, or does the code span
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">take precedence ?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">[a backtick (`)](/url) and [another backtick (`)](/url).
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">9.  <span class="content"><span class="paragraph"><span class="string">What are the precedence rules for markers of emphasis and strong
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">emphasis?  For example, how should the following be parsed?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">*foo *bar* baz*
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">10. <span class="content"><span class="paragraph"><span class="string">What are the precedence rules between block-level and inline-level
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">structure?  For example, how should the following be parsed?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">- `a long code span can contain a hyphen like this
</span></span>    <span class="content"><span class="fenced code block">  - and it can screw things up`
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">11. <span class="content"><span class="paragraph"><span class="string">Can list items include section headers?  (</span><span class="code">`Markdown.pl`</span><span class="string"> does not
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">allow this, but does allow blockquotes to include headers.)</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">- # Heading
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">12. <span class="content"><span class="paragraph"><span class="string">Can list items be empty?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">* a
</span></span>    <span class="content"><span class="fenced code block">*
</span></span>    <span class="content"><span class="fenced code block">* b
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">13. <span class="content"><span class="paragraph"><span class="string">Can link references be defined inside block quotes or list items?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">&gt; Blockquote [foo].
</span></span>    <span class="content"><span class="fenced code block">&gt;
</span></span>    <span class="content"><span class="fenced code block">&gt; [foo]: /url
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">14. <span class="content"><span class="paragraph"><span class="string">If there are multiple definitions for the same reference, which takes
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">precedence?</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">``` markdown
</span></span>    <span class="content"><span class="fenced code block">[foo]: /url1
</span></span>    <span class="content"><span class="fenced code block">[foo]: /url2
</span></span><span class="content"><span class="fenced code block">
</span></span>    <span class="content"><span class="fenced code block">[foo][]
</span></span>    <span class="content"><span class="fenced code block">```
</span></span></span></span>
<span class="paragraph"><span class="string">In the absence of a spec, early implementers consulted </span><span class="code">`Markdown.pl`</span><span class="string">
to resolve these ambiguities.  But </span><span class="code">`Markdown.pl`</span><span class="string"> was quite buggy, and
gave manifestly bad results in many cases, so it was not a
satisfactory replacement for a spec.</span>
</span>
<span class="paragraph"><span class="string">Because there is no unambiguous spec, implementations have diverged
considerably.  As a result, users are often surprised to find that
a document that renders one way on one system (say, a github wiki)
renders differently on another (say, converting to docbook using
pandoc).  To make matters worse, because nothing in Markdown counts
as a &quot;syntax error,&quot; the divergence often isn't discovered right away.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;about-this-document&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 1.3 About this document</span></span>
</span>
<span class="paragraph"><span class="string">This document attempts to specify Markdown syntax unambiguously.
It contains many examples with side-by-side Markdown and
HTML.  These are intended to double as conformance tests.  An
accompanying script </span><span class="code">`spec_tests.py`</span><span class="string"> can be used to run the tests
against any Markdown program:</span>
</span>
<span class="indented code block">    python test/spec_tests.py --spec spec.txt --program PROGRAM

</span><span class="paragraph"><span class="string">Since this document describes how Markdown is to be parsed into
an abstract syntax tree, it would have made sense to use an abstract
representation of the syntax tree instead of HTML.  But HTML is capable
of representing the structural distinctions we need to make, and the
choice of HTML for the tests makes it possible to run the tests against
an implementation without writing an abstract syntax tree renderer.</span>
</span>
<span class="paragraph"><span class="string">This document is generated from a text file, </span><span class="code">`spec.txt`</span><span class="string">, written
in Markdown with a small extension for the side-by-side tests.
The script </span><span class="code">`spec2md.pl`</span><span class="string"> can be used to turn </span><span class="code">`spec.txt`</span><span class="string"> into pandoc
Markdown, which can then be converted into other formats.</span>
</span>
<span class="paragraph"><span class="string">In the examples, the </span><span class="code">`→`</span><span class="string"> character is used to represent tabs.</span>
</span>
<span class="atx header"># <span class="content"><span class="html">&lt;a id=&quot;preliminaries&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 2 Preliminaries</span></span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;characters-and-lines&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 2.1 Characters and lines</span></span>
</span>
<span class="paragraph"><span class="string">Any sequence of </span><span class="link">[<span class="string">character</span>]</span><span class="string">s is a valid CommonMark
document.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">character</span>](<span class="destination">@character</span>)</span><span class="string"> is a unicode code point.
This spec does not specify an encoding; it thinks of lines as composed
of characters rather than bytes.  A conforming parser may be limited
to a certain encoding.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">line</span>](<span class="destination">@line</span>)</span><span class="string"> is a sequence of zero or more </span><span class="link">[<span class="string">character</span>]</span><span class="string">s
followed by a </span><span class="link">[<span class="string">line ending</span>]</span><span class="string"> or by the end of file.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">line ending</span>](<span class="destination">@line-ending</span>)</span><span class="string"> is, depending on the platform, a
newline (</span><span class="code">`U+000A`</span><span class="string">), carriage return (</span><span class="code">`U+000D`</span><span class="string">), or
carriage return + newline.</span>
</span>
<span class="paragraph"><span class="string">For security reasons, a conforming parser must strip or replace the
Unicode character </span><span class="code">`U+0000`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A line containing no characters, or a line containing only spaces
(</span><span class="code">`U+0020`</span><span class="string">) or tabs (</span><span class="code">`U+0009`</span><span class="string">), is called a </span><span class="link">[<span class="string">blank line</span>](<span class="destination">@blank-line</span>)</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">The following definitions of character classes will be used in this spec:</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">whitespace character</span>](<span class="destination">@whitespace-character</span>)</span><span class="string"> is a space
(</span><span class="code">`U+0020`</span><span class="string">), tab (</span><span class="code">`U+0009`</span><span class="string">), carriage return (</span><span class="code">`U+000D`</span><span class="string">), or
newline (</span><span class="code">`U+000A`</span><span class="string">).</span>
</span>
<span class="paragraph"><span class="link">[<span class="string">Whitespace</span>](<span class="destination">@whitespace</span>)</span><span class="string"> is a sequence of one or more </span><span class="link">[<span class="string">whitespace
character</span>]</span><span class="string">s.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">unicode whitespace character</span>](<span class="destination">@unicode-whitespace-character</span>)</span><span class="string"> is
any code point in the unicode </span><span class="code">`Zs`</span><span class="string"> class, or a tab (</span><span class="code">`U+0009`</span><span class="string">),
carriage return (</span><span class="code">`U+000D`</span><span class="string">), newline (</span><span class="code">`U+000A`</span><span class="string">), or form feed
(</span><span class="code">`U+000C`</span><span class="string">).</span>
</span>
<span class="paragraph"><span class="link">[<span class="string">Unicode whitespace</span>](<span class="destination">@unicode-whitespace</span>)</span><span class="string"> is a sequence of one
or more </span><span class="link">[<span class="string">unicode whitespace character</span>]</span><span class="string">s.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">non-space character</span>](<span class="destination">@non-space-character</span>)</span><span class="string"> is anything but </span><span class="code">`U+0020`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">ASCII punctuation character</span>](<span class="destination">@ascii-punctuation-character</span>)</span><span class="string">
is </span><span class="code">`!`</span><span class="string">, </span><span class="code">`&quot;`</span><span class="string">, </span><span class="code">`#`</span><span class="string">, </span><span class="code">`$`</span><span class="string">, </span><span class="code">`%`</span><span class="string">, </span><span class="code">`&amp;`</span><span class="string">, </span><span class="code">`'`</span><span class="string">, </span><span class="code">`(`</span><span class="string">, </span><span class="code">`)`</span><span class="string">,
</span><span class="code">`*`</span><span class="string">, </span><span class="code">`+`</span><span class="string">, </span><span class="code">`,`</span><span class="string">, </span><span class="code">`-`</span><span class="string">, </span><span class="code">`.`</span><span class="string">, </span><span class="code">`/`</span><span class="string">, </span><span class="code">`:`</span><span class="string">, </span><span class="code">`;`</span><span class="string">, </span><span class="code">`&lt;`</span><span class="string">, </span><span class="code">`=`</span><span class="string">, </span><span class="code">`&gt;`</span><span class="string">, </span><span class="code">`?`</span><span class="string">, </span><span class="code">`@`</span><span class="string">,
</span><span class="code">`[`</span><span class="string">, </span><span class="code">`\`</span><span class="string">, </span><span class="code">`]`</span><span class="string">, </span><span class="code">`^`</span><span class="string">, </span><span class="code">`_`</span><span class="string">, </span><span class="code">`` ` ``</span><span class="string">, </span><span class="code">`{`</span><span class="string">, </span><span class="code">`|`</span><span class="string">, </span><span class="code">`}`</span><span class="string">, or </span><span class="code">`~`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">punctuation character</span>](<span class="destination">@punctuation-character</span>)</span><span class="string"> is an </span><span class="link">[<span class="string">ASCII
punctuation character</span>]</span><span class="string"> or anything in
the unicode classes </span><span class="code">`Pc`</span><span class="string">, </span><span class="code">`Pd`</span><span class="string">, </span><span class="code">`Pe`</span><span class="string">, </span><span class="code">`Pf`</span><span class="string">, </span><span class="code">`Pi`</span><span class="string">, </span><span class="code">`Po`</span><span class="string">, or </span><span class="code">`Ps`</span><span class="string">.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;tab-expansion&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 2.2 Tab expansion</span></span>
</span>
<span class="paragraph"><span class="string">Tabs in lines are expanded to spaces, with a tab stop of 4 characters:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
→foo→baz→→bim
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;foo␣baz␣␣␣␣␣bim
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣a→a
␣␣␣␣ὐ→a
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;a␣␣␣a
ὐ␣␣␣a
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header"># <span class="content"><span class="html">&lt;a id=&quot;blocks-and-inlines&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 3 Blocks and inlines</span></span>
</span>
<span class="paragraph"><span class="string">We can think of a document as a sequence of
</span><span class="link">[<span class="string">blocks</span>](<span class="destination">@block</span>)</span><span class="string">---structural
elements like paragraphs, block quotations,
lists, headers, rules, and code blocks.  Blocks can contain other
blocks, or they can contain </span><span class="link">[<span class="string">inline</span>](<span class="destination">@inline</span>)</span><span class="string"> content:
words, spaces, links, emphasized text, images, and inline code.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;precedence&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 3.1 Precedence</span></span>
</span>
<span class="paragraph"><span class="string">Indicators of block structure always take precedence over indicators
of inline structure.  So, for example, the following is a list with
two items, not a list with one item containing a code span:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣`one
-␣two`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;`one&lt;/li&gt;
&lt;li&gt;two`&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This means that parsing can proceed in two steps:  first, the block
structure of the document can be discerned; second, text lines inside
paragraphs, headers, and other block constructs can be parsed for inline
structure.  The second step requires information about link reference
definitions that will be available only at the end of the first
step.  Note that the first step requires processing lines in sequence,
but the second can be parallelized, since the inline parsing of
one block element does not affect the inline parsing of any other.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;container-blocks-and-leaf-blocks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 3.2 Container blocks and leaf blocks</span></span>
</span>
<span class="paragraph"><span class="string">We can divide blocks into two types:
</span><span class="link">[<span class="string">container block</span>](<span class="destination">@container-block</span>)</span><span class="string">s,
which can contain other blocks, and </span><span class="link">[<span class="string">leaf block</span>](<span class="destination">@leaf-block</span>)</span><span class="string">s,
which cannot.</span>
</span>
<span class="atx header"># <span class="content"><span class="html">&lt;a id=&quot;leaf-blocks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4 Leaf blocks</span></span>
</span>
<span class="paragraph"><span class="string">This section describes the different kinds of leaf block that make up a
Markdown document.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;horizontal-rules&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.1 Horizontal rules</span></span>
</span>
<span class="paragraph"><span class="string">A line consisting of 0-3 spaces of indentation, followed by a sequence
of three or more matching </span><span class="code">`-`</span><span class="string">, </span><span class="code">`_`</span><span class="string">, or </span><span class="code">`*`</span><span class="string"> characters, each followed
optionally by any number of spaces, forms a
</span><span class="link">[<span class="string">horizontal rule</span>](<span class="destination">@horizontal-rule</span>)</span><span class="string">.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
***
---
___
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
&lt;hr␣/&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Wrong characters:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
+++
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;+++&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
===
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;===&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Not enough characters:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
--
**
__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;--
**
__&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">One to three spaces indent are allowed:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣***
␣␣***
␣␣␣***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
&lt;hr␣/&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Four spaces is too many:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;***
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
␣␣␣␣***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo
***&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">More than three characters may be used:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_____________________________________
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Spaces are allowed between the characters:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣-␣-␣-
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣**␣␣*␣**␣*␣**␣*␣**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣␣␣␣␣-␣␣␣␣␣␣-␣␣␣␣␣␣-
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Spaces are allowed at the end:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣-␣-␣-␣␣␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, no other characters may occur in the line:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_␣_␣_␣_␣a

a------

---a---
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_␣_␣_␣_␣a&lt;/p&gt;
&lt;p&gt;a------&lt;/p&gt;
&lt;p&gt;---a---&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">It is required that all of the </span><span class="link">[<span class="string">non-space character</span>]</span><span class="string">s be the same.
So, this is not a horizontal rule:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣*-*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;-&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Horizontal rules do not need blank lines before or after:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
***
-␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;
&lt;hr␣/&gt;
&lt;ul&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Horizontal rules can interrupt a paragraph:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
***
bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo&lt;/p&gt;
&lt;hr␣/&gt;
&lt;p&gt;bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If a line of dashes that meets the above conditions for being a
horizontal rule could also be interpreted as the underline of a </span><span class="link">[<span class="string">setext
header</span>]</span><span class="string">, the interpretation as a
</span><span class="link">[<span class="string">setext header</span>]</span><span class="string"> takes precedence. Thus, for example,
this is a setext header, not a paragraph followed by a horizontal rule:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
---
bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;Foo&lt;/h2&gt;
&lt;p&gt;bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">When both a horizontal rule and a list item are possible
interpretations of a line, the horizontal rule takes precedence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*␣Foo
*␣*␣*
*␣Bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;Foo&lt;/li&gt;
&lt;/ul&gt;
&lt;hr␣/&gt;
&lt;ul&gt;
&lt;li&gt;Bar&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If you want a horizontal rule in a list item, use a different bullet:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣Foo
-␣*␣*␣*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;Foo&lt;/li&gt;
&lt;li&gt;
&lt;hr␣/&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;atx-headers&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.2 ATX headers</span></span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">ATX header</span>](<span class="destination">@atx-header</span>)</span><span class="string">
consists of a string of characters, parsed as inline content, between an
opening sequence of 1--6 unescaped </span><span class="code">`#`</span><span class="string"> characters and an optional
closing sequence of any number of </span><span class="code">`#`</span><span class="string"> characters.  The opening sequence
of </span><span class="code">`#`</span><span class="string"> characters cannot be followed directly by a
</span><span class="link">[<span class="string">non-space character</span>]</span><span class="string">.
The optional closing sequence of </span><span class="code">`#`</span><span class="string">s must be preceded by a space and may be
followed by spaces only.  The opening </span><span class="code">`#`</span><span class="string"> character may be indented 0-3
spaces.  The raw contents of the header are stripped of leading and
trailing spaces before being parsed as inline content.  The header level
is equal to the number of </span><span class="code">`#`</span><span class="string"> characters in the opening sequence.</span>
</span>
<span class="paragraph"><span class="string">Simple headers:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#␣foo
##␣foo
###␣foo
####␣foo
#####␣foo
######␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h1&gt;foo&lt;/h1&gt;
&lt;h2&gt;foo&lt;/h2&gt;
&lt;h3&gt;foo&lt;/h3&gt;
&lt;h4&gt;foo&lt;/h4&gt;
&lt;h5&gt;foo&lt;/h5&gt;
&lt;h6&gt;foo&lt;/h6&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">More than six </span><span class="code">`#`</span><span class="string"> characters is not a header:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#######␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;#######␣foo&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A space is required between the </span><span class="code">`#`</span><span class="string"> characters and the header's
contents.  Note that many implementations currently do not require
the space.  However, the space was required by the </span><span class="link">[<span class="string">original ATX
implementation</span>](<span class="destination">http://www.aaronsw.com/2002/atx/atx.py</span>)</span><span class="string">, and it helps
prevent things like the following from being parsed as headers:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#5␣bolt
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;#5␣bolt&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not a header, because the first </span><span class="code">`#`</span><span class="string"> is escaped:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\##␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;##␣foo&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Contents are parsed as inlines:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#␣foo␣*bar*␣\*baz\*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h1&gt;foo␣&lt;em&gt;bar&lt;/em&gt;␣*baz*&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Leading and trailing blanks are ignored in parsing inline content:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣foo␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h1&gt;foo&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">One to three spaces indentation are allowed:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣###␣foo
␣␣##␣foo
␣␣␣#␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h3&gt;foo&lt;/h3&gt;
&lt;h2&gt;foo&lt;/h2&gt;
&lt;h1&gt;foo&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Four spaces are too much:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣#␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;#␣foo
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo
␣␣␣␣#␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo
#␣bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A closing sequence of </span><span class="code">`#`</span><span class="string"> characters is optional:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
##␣foo␣##
␣␣###␣␣␣bar␣␣␣␣###
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;foo&lt;/h2&gt;
&lt;h3&gt;bar&lt;/h3&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">It need not be the same length as the opening sequence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#␣foo␣##################################
#####␣foo␣##
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h1&gt;foo&lt;/h1&gt;
&lt;h5&gt;foo&lt;/h5&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Spaces are allowed after the closing sequence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
###␣foo␣###␣␣␣␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h3&gt;foo&lt;/h3&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A sequence of </span><span class="code">`#`</span><span class="string"> characters with a
</span><span class="link">[<span class="string">non-space character</span>]</span><span class="string"> following it
is not a closing sequence, but counts as part of the contents of the
header:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
###␣foo␣###␣b
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h3&gt;foo␣###␣b&lt;/h3&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The closing sequence must be preceded by a space:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#␣foo#
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h1&gt;foo#&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Backslash-escaped </span><span class="code">`#`</span><span class="string"> characters do not count as part
of the closing sequence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
###␣foo␣\###
##␣foo␣#\##
#␣foo␣\#
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h3&gt;foo␣###&lt;/h3&gt;
&lt;h2&gt;foo␣###&lt;/h2&gt;
&lt;h1&gt;foo␣#&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">ATX headers need not be separated from surrounding content by blank
lines, and they can interrupt paragraphs:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
****
##␣foo
****
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
&lt;h2&gt;foo&lt;/h2&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo␣bar
#␣baz
Bar␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo␣bar&lt;/p&gt;
&lt;h1&gt;baz&lt;/h1&gt;
&lt;p&gt;Bar␣foo&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">ATX headers can be empty:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
##␣
#
###␣###
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;&lt;/h2&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h3&gt;&lt;/h3&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;setext-headers&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.3 Setext headers</span></span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">setext header</span>](<span class="destination">@setext-header</span>)</span><span class="string">
consists of a line of text, containing at least one
</span><span class="link">[<span class="string">non-space character</span>]</span><span class="string">,
with no more than 3 spaces indentation, followed by a </span><span class="link">[<span class="string">setext header
underline</span>]</span><span class="string">.  The line of text must be
one that, were it not followed by the setext header underline,
would be interpreted as part of a paragraph:  it cannot be a code
block, header, blockquote, horizontal rule, or list.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">setext header underline</span>](<span class="destination">@setext-header-underline</span>)</span><span class="string"> is a sequence of
</span><span class="code">`=`</span><span class="string"> characters or a sequence of </span><span class="code">`-`</span><span class="string"> characters, with no more than 3
spaces indentation and any number of trailing spaces.  If a line
containing a single </span><span class="code">`-`</span><span class="string"> can be interpreted as an
empty </span><span class="link">[<span class="string">list items</span>]</span><span class="string">, it should be interpreted this way
and not as a </span><span class="link">[<span class="string">setext header underline</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">The header is a level 1 header if </span><span class="code">`=`</span><span class="string"> characters are used in the
</span><span class="link">[<span class="string">setext header underline</span>]</span><span class="string">, and a level 2
header if </span><span class="code">`-`</span><span class="string"> characters are used.  The contents of the header are the
result of parsing the first line as Markdown inline content.</span>
</span>
<span class="paragraph"><span class="string">In general, a setext header need not be preceded or followed by a
blank line.  However, it cannot interrupt a paragraph, so when a
setext header comes after a paragraph, a blank line is needed between
them.</span>
</span>
<span class="paragraph"><span class="string">Simple examples:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo␣*bar*
=========

Foo␣*bar*
---------
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h1&gt;Foo␣&lt;em&gt;bar&lt;/em&gt;&lt;/h1&gt;
&lt;h2&gt;Foo␣&lt;em&gt;bar&lt;/em&gt;&lt;/h2&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The underlining can be any length:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
-------------------------

Foo
=
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;Foo&lt;/h2&gt;
&lt;h1&gt;Foo&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The header content can be indented up to three spaces, and need
not line up with the underlining:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣Foo
---

␣␣Foo
-----

␣␣Foo
␣␣===
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;Foo&lt;/h2&gt;
&lt;h2&gt;Foo&lt;/h2&gt;
&lt;h1&gt;Foo&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Four spaces indent is too much:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣Foo
␣␣␣␣---

␣␣␣␣Foo
---
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;Foo
---

Foo
&lt;/code&gt;&lt;/pre&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The setext header underline can be indented up to three spaces, and
may have trailing spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
␣␣␣----␣␣␣␣␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;Foo&lt;/h2&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Four spaces is too much:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
␣␣␣␣---
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo
---&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The setext header underline cannot contain internal spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
=␣=

Foo
---␣-
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo
=␣=&lt;/p&gt;
&lt;p&gt;Foo&lt;/p&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Trailing spaces in the content line do not cause a line break:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo␣␣
-----
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;Foo&lt;/h2&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Nor does a backslash at the end:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo\
----
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;Foo\&lt;/h2&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Since indicators of block structure take precedence over
indicators of inline structure, the following are setext headers:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`Foo
----
`

&lt;a␣title=&quot;a␣lot
---
of␣dashes&quot;/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;`Foo&lt;/h2&gt;
&lt;p&gt;`&lt;/p&gt;
&lt;h2&gt;&amp;lt;a␣title=&amp;quot;a␣lot&lt;/h2&gt;
&lt;p&gt;of␣dashes&amp;quot;/&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The setext header underline cannot be a </span><span class="link">[<span class="string">lazy continuation
line</span>]</span><span class="string"> in a list item or block quote:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣Foo
---
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;Foo&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣Foo
---
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;Foo&lt;/li&gt;
&lt;/ul&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A setext header cannot interrupt a paragraph:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
Bar
---

Foo
Bar
===
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo
Bar&lt;/p&gt;
&lt;hr␣/&gt;
&lt;p&gt;Foo
Bar
===&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">But in general a blank line is not required before or after:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
---
Foo
---
Bar
---
Baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
&lt;h2&gt;Foo&lt;/h2&gt;
&lt;h2&gt;Bar&lt;/h2&gt;
&lt;p&gt;Baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Setext headers cannot be empty:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown

====
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;====&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Setext header text lines must not be interpretable as block
constructs other than paragraphs.  So, the line of dashes
in these examples gets interpreted as a horizontal rule:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
---
---
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;hr␣/&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
-----
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣foo
---
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;foo
&lt;/code&gt;&lt;/pre&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣foo
-----
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If you want a header with </span><span class="code">`&gt; foo`</span><span class="string"> as its literal text, you can
use backslash escapes:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\&gt;␣foo
------
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;&amp;gt;␣foo&lt;/h2&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;indented-code-blocks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.4 Indented code blocks</span></span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">indented code block</span>](<span class="destination">@indented-code-block</span>)</span><span class="string"> is composed of one or more
</span><span class="link">[<span class="string">indented chunk</span>]</span><span class="string">s separated by blank lines.
An </span><span class="link">[<span class="string">indented chunk</span>](<span class="destination">@indented-chunk</span>)</span><span class="string"> is a sequence of non-blank lines,
each indented four or more spaces. The contents of the code block are
the literal contents of the lines, including trailing
</span><span class="link">[<span class="string">line ending</span>]</span><span class="string">s, minus four spaces of indentation.
An indented code block has no </span><span class="link">[<span class="string">info string</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An indented code block cannot interrupt a paragraph, so there must be
a blank line between a paragraph and a following indented code block.
(A blank line is not needed, however, between a code block and a following
paragraph.)</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣a␣simple
␣␣␣␣␣␣indented␣code␣block
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;a␣simple
␣␣indented␣code␣block
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The contents are literal text, and do not get parsed as Markdown:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣&lt;a/&gt;
␣␣␣␣*hi*

␣␣␣␣-␣one
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;&amp;lt;a/&amp;gt;
*hi*

-␣one
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here we have three chunks separated by blank lines:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣chunk1

␣␣␣␣chunk2
␣␣
␣
␣
␣␣␣␣chunk3
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;chunk1

chunk2



chunk3
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Any initial spaces beyond four will be included in the content, even
in interior blank lines:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣chunk1
␣␣␣␣␣␣
␣␣␣␣␣␣chunk2
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;chunk1
␣␣
␣␣chunk2
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">An indented code block cannot interrupt a paragraph.  (This
allows hanging indents and the like.)</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
␣␣␣␣bar

`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo
bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, any non-blank line with fewer than four leading spaces ends
the code block immediately.  So a paragraph may occur immediately
after indented code:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣foo
bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;foo
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">And indented code can occur immediately before and after other kinds of
blocks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#␣Header
␣␣␣␣foo
Header
------
␣␣␣␣foo
----
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h1&gt;Header&lt;/h1&gt;
&lt;pre&gt;&lt;code&gt;foo
&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;Header&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;foo
&lt;/code&gt;&lt;/pre&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The first line can be indented more than four spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣␣␣␣␣foo
␣␣␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;␣␣␣␣foo
bar
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Blank lines preceding or following an indented code block
are not included in it:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown

␣␣␣␣
␣␣␣␣foo
␣␣␣␣

`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;foo
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Trailing spaces are included in the code block's content:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣foo␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;foo␣␣
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>

<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;fenced-code-blocks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.5 Fenced code blocks</span></span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">code fence</span>](<span class="destination">@code-fence</span>)</span><span class="string"> is a sequence
of at least three consecutive backtick characters (</span><span class="code">`` ` ``</span><span class="string">) or
tildes (</span><span class="code">`~`</span><span class="string">).  (Tildes and backticks cannot be mixed.)
A </span><span class="link">[<span class="string">fenced code block</span>](<span class="destination">@fenced-code-block</span>)</span><span class="string">
begins with a code fence, indented no more than three spaces.</span>
</span>
<span class="paragraph"><span class="string">The line with the opening code fence may optionally contain some text
following the code fence; this is trimmed of leading and trailing
spaces and called the </span><span class="link">[<span class="string">info string</span>](<span class="destination">@info-string</span>)</span><span class="string">.
The </span><span class="link">[<span class="string">info string</span>]</span><span class="string"> may not contain any backtick
characters.  (The reason for this restriction is that otherwise
some inline code would be incorrectly interpreted as the
beginning of a fenced code block.)</span>
</span>
<span class="paragraph"><span class="string">The content of the code block consists of all subsequent lines, until
a closing </span><span class="link">[<span class="string">code fence</span>]</span><span class="string"> of the same type as the code block
began with (backticks or tildes), and with at least as many backticks
or tildes as the opening code fence.  If the leading code fence is
indented N spaces, then up to N spaces of indentation are removed from
each line of the content (if present).  (If a content line is not
indented, it is preserved unchanged.  If it is indented less than N
spaces, all of the indentation is removed.)</span>
</span>
<span class="paragraph"><span class="string">The closing code fence may be indented up to three spaces, and may be
followed only by spaces, which are ignored.  If the end of the
containing block (or document) is reached and no closing code fence
has been found, the code block contains all of the lines after the
opening code fence until the end of the containing block (or
document).  (An alternative spec would require backtracking in the
event that a closing code fence is not found.  But this makes parsing
much less efficient, and there seems to be no real down side to the
behavior described here.)</span>
</span>
<span class="paragraph"><span class="string">A fenced code block may interrupt a paragraph, and does not require
a blank line either before or after.</span>
</span>
<span class="paragraph"><span class="string">The content of a code fence is treated as literal text, not parsed
as inlines.  The first word of the </span><span class="link">[<span class="string">info string</span>]</span><span class="string"> is typically used to
specify the language of the code sample, and rendered in the </span><span class="code">`class`</span><span class="string">
attribute of the </span><span class="code">`code`</span><span class="string"> tag.  However, this spec does not mandate any
particular treatment of the </span><span class="link">[<span class="string">info string</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">Here is a simple example with backticks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```
&lt;
␣&gt;
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;&amp;lt;
␣&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">With tildes:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
~~~
&lt;
␣&gt;
~~~
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;&amp;lt;
␣&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The closing code fence must use the same character as the opening
fence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```
aaa
~~~
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
~~~
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
~~~
aaa
```
~~~
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
```
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The closing code fence must be at least as long as the opening fence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
````
aaa
```
``````
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
```
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
~~~~
aaa
~~~
~~~~
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
~~~
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Unclosed code blocks are closed by the end of the document:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`````

```
aaa
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;
```
aaa
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A code block can have all empty lines as its content:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```

␣␣
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;
␣␣
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A code block can be empty:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Fences can be indented.  If the opening fence is indented,
content lines will have equivalent opening indentation removed,
if present:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣```
␣aaa
aaa
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
aaa
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣```
aaa
␣␣aaa
aaa
␣␣```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
aaa
aaa
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣```
␣␣␣aaa
␣␣␣␣aaa
␣␣aaa
␣␣␣```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
␣aaa
aaa
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Four spaces indentation produces an indented code block:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣```
␣␣␣␣aaa
␣␣␣␣```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;```
aaa
```
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Closing fences may be indented by 0-3 spaces, and their indentation
need not match that of the opening fence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```
aaa
␣␣```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣```
aaa
␣␣```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not a closing fence, because it is indented 4 spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```
aaa
␣␣␣␣```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
␣␣␣␣```
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">Code fences (opening and closing) cannot contain internal spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```␣```
aaa
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;&lt;/code&gt;
aaa&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
~~~~~~
aaa
~~~␣~~
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
~~~␣~~
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Fenced code blocks can interrupt paragraphs, and can be followed
directly by paragraphs, without a blank line between:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo
```
bar
```
baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bar
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Other blocks can also occur before and after fenced code blocks
without an intervening blank line:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo
---
~~~
bar
~~~
#␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h2&gt;foo&lt;/h2&gt;
&lt;pre&gt;&lt;code&gt;bar
&lt;/code&gt;&lt;/pre&gt;
&lt;h1&gt;baz&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">info string</span>]</span><span class="string"> can be provided after the opening code fence.
Opening and closing spaces will be stripped, and the first word, prefixed
with </span><span class="code">`language-`</span><span class="string">, is used as the value for the </span><span class="code">`class`</span><span class="string"> attribute of the
</span><span class="code">`code`</span><span class="string"> element within the enclosing </span><span class="code">`pre`</span><span class="string"> element.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```ruby
def␣foo(x)
␣␣return␣3
end
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code␣class=&quot;language-ruby&quot;&gt;def␣foo(x)
␣␣return␣3
end
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
~~~~␣␣␣␣ruby␣startline=3␣$%@#$
def␣foo(x)
␣␣return␣3
end
~~~~~~~
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code␣class=&quot;language-ruby&quot;&gt;def␣foo(x)
␣␣return␣3
end
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
````;
````
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code␣class=&quot;language-;&quot;&gt;&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="link">[<span class="string">Info string</span>]</span><span class="string">s for backtick code blocks cannot contain backticks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```␣aa␣```
foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;aa&lt;/code&gt;
foo&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Closing code fences cannot have </span><span class="link">[<span class="string">info string</span>]</span><span class="string">s:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```
```␣aaa
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;```␣aaa
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>

<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;html-blocks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.6 HTML blocks</span></span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">HTML block tag</span>](<span class="destination">@html-block-tag</span>)</span><span class="string"> is
an </span><span class="link">[<span class="string">open tag</span>]</span><span class="string"> or </span><span class="link">[<span class="string">closing tag</span>]</span><span class="string"> whose tag
name is one of the following (case-insensitive):
</span><span class="code">`article`</span><span class="string">, </span><span class="code">`header`</span><span class="string">, </span><span class="code">`aside`</span><span class="string">, </span><span class="code">`hgroup`</span><span class="string">, </span><span class="code">`blockquote`</span><span class="string">, </span><span class="code">`hr`</span><span class="string">, </span><span class="code">`iframe`</span><span class="string">,
</span><span class="code">`body`</span><span class="string">, </span><span class="code">`li`</span><span class="string">, </span><span class="code">`map`</span><span class="string">, </span><span class="code">`button`</span><span class="string">, </span><span class="code">`object`</span><span class="string">, </span><span class="code">`canvas`</span><span class="string">, </span><span class="code">`ol`</span><span class="string">, </span><span class="code">`caption`</span><span class="string">,
</span><span class="code">`output`</span><span class="string">, </span><span class="code">`col`</span><span class="string">, </span><span class="code">`p`</span><span class="string">, </span><span class="code">`colgroup`</span><span class="string">, </span><span class="code">`pre`</span><span class="string">, </span><span class="code">`dd`</span><span class="string">, </span><span class="code">`progress`</span><span class="string">, </span><span class="code">`div`</span><span class="string">,
</span><span class="code">`section`</span><span class="string">, </span><span class="code">`dl`</span><span class="string">, </span><span class="code">`table`</span><span class="string">, </span><span class="code">`td`</span><span class="string">, </span><span class="code">`dt`</span><span class="string">, </span><span class="code">`tbody`</span><span class="string">, </span><span class="code">`embed`</span><span class="string">, </span><span class="code">`textarea`</span><span class="string">,
</span><span class="code">`fieldset`</span><span class="string">, </span><span class="code">`tfoot`</span><span class="string">, </span><span class="code">`figcaption`</span><span class="string">, </span><span class="code">`th`</span><span class="string">, </span><span class="code">`figure`</span><span class="string">, </span><span class="code">`thead`</span><span class="string">, </span><span class="code">`footer`</span><span class="string">,
</span><span class="code">`tr`</span><span class="string">, </span><span class="code">`form`</span><span class="string">, </span><span class="code">`ul`</span><span class="string">, </span><span class="code">`h1`</span><span class="string">, </span><span class="code">`h2`</span><span class="string">, </span><span class="code">`h3`</span><span class="string">, </span><span class="code">`h4`</span><span class="string">, </span><span class="code">`h5`</span><span class="string">, </span><span class="code">`h6`</span><span class="string">, </span><span class="code">`video`</span><span class="string">,
</span><span class="code">`script`</span><span class="string">, </span><span class="code">`style`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">HTML block</span>](<span class="destination">@html-block</span>)</span><span class="string"> begins with an
</span><span class="link">[<span class="string">HTML block tag</span>]</span><span class="string">, </span><span class="link">[<span class="string">HTML comment</span>]</span><span class="string">, </span><span class="link">[<span class="string">processing instruction</span>]</span><span class="string">,
</span><span class="link">[<span class="string">declaration</span>]</span><span class="string">, or </span><span class="link">[<span class="string">CDATA section</span>]</span><span class="string">.
It ends when a </span><span class="link">[<span class="string">blank line</span>]</span><span class="string"> or the end of the
input is encountered.  The initial line may be indented up to three
spaces, and subsequent lines may have any indentation.  The contents
of the HTML block are interpreted as raw HTML, and will not be escaped
in HTML output.</span>
</span>
<span class="paragraph"><span class="string">Some simple examples:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;table&gt;
␣␣&lt;tr&gt;
␣␣␣␣&lt;td&gt;
␣␣␣␣␣␣␣␣␣␣␣hi
␣␣␣␣&lt;/td&gt;
␣␣&lt;/tr&gt;
&lt;/table&gt;

okay.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;table&gt;
␣␣&lt;tr&gt;
␣␣␣␣&lt;td&gt;
␣␣␣␣␣␣␣␣␣␣␣hi
␣␣␣␣&lt;/td&gt;
␣␣&lt;/tr&gt;
&lt;/table&gt;
&lt;p&gt;okay.&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣&lt;div&gt;
␣␣*hello*
␣␣␣␣␣␣␣␣␣&lt;foo&gt;&lt;a&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
␣&lt;div&gt;
␣␣*hello*
␣␣␣␣␣␣␣␣␣&lt;foo&gt;&lt;a&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here we have two HTML blocks with a Markdown paragraph between them:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;DIV␣CLASS=&quot;foo&quot;&gt;

*Markdown*

&lt;/DIV&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;DIV␣CLASS=&quot;foo&quot;&gt;
&lt;p&gt;&lt;em&gt;Markdown&lt;/em&gt;&lt;/p&gt;
&lt;/DIV&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">In the following example, what looks like a Markdown code block
is actually part of the HTML block, which continues until a blank
line or the end of the document is reached:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;div&gt;&lt;/div&gt;
```␣c
int␣x␣=␣33;
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;div&gt;&lt;/div&gt;
```␣c
int␣x␣=␣33;
```
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A comment:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;!--␣Foo
bar
␣␣␣baz␣--&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;!--␣Foo
bar
␣␣␣baz␣--&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A processing instruction:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;?php
␣␣echo␣'&gt;';
?&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;?php
␣␣echo␣'&gt;';
?&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">CDATA:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;![CDATA[
function␣matchwo(a,b)
{
if␣(a␣&lt;␣b␣&amp;&amp;␣a␣&lt;␣0)␣then
␣␣{
␣␣return␣1;
␣␣}
else
␣␣{
␣␣return␣0;
␣␣}
}
]]&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;![CDATA[
function␣matchwo(a,b)
{
if␣(a␣&lt;␣b␣&amp;&amp;␣a␣&lt;␣0)␣then
␣␣{
␣␣return␣1;
␣␣}
else
␣␣{
␣␣return␣0;
␣␣}
}
]]&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The opening tag can be indented 1-3 spaces, but not 4:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣&lt;!--␣foo␣--&gt;

␣␣␣␣&lt;!--␣foo␣--&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
␣␣&lt;!--␣foo␣--&gt;
&lt;pre&gt;&lt;code&gt;&amp;lt;!--␣foo␣--&amp;gt;
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">An HTML block can interrupt a paragraph, and need not be preceded
by a blank line.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
&lt;div&gt;
bar
&lt;/div&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo&lt;/p&gt;
&lt;div&gt;
bar
&lt;/div&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, a following blank line is always needed, except at the end of
a document:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;div&gt;
bar
&lt;/div&gt;
*foo*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;div&gt;
bar
&lt;/div&gt;
*foo*
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">An incomplete HTML block tag may also start an HTML block:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;div␣class
foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;div␣class
foo
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This rule differs from John Gruber's original Markdown syntax
specification, which says:</span>
</span>
<span class="quote block">&gt; <span class="content"><span class="paragraph"><span class="string">The only restrictions are that block-level HTML elements —
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">e.g. </span><span class="code">`&lt;div&gt;`</span><span class="string">, </span><span class="code">`&lt;table&gt;`</span><span class="string">, </span><span class="code">`&lt;pre&gt;`</span><span class="string">, </span><span class="code">`&lt;p&gt;`</span><span class="string">, etc. — must be separated from
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">surrounding content by blank lines, and the start and end tags of the
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">block should not be indented with tabs or spaces.</span>
</span></span></span>
<span class="paragraph"><span class="string">In some ways Gruber's rule is more restrictive than the one given
here:</span>
</span>
<span class="list"><span class="list item">- <span class="content"><span class="paragraph"><span class="string">It requires that an HTML block be preceded by a blank line.</span>
</span></span></span><span class="list item">- <span class="content"><span class="paragraph"><span class="string">It does not allow the start tag to be indented.</span>
</span></span></span><span class="list item">- <span class="content"><span class="paragraph"><span class="string">It requires a matching end tag, which it also does not allow to
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">be indented.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">Indeed, most Markdown implementations, including some of Gruber's
own perl implementations, do not impose these restrictions.</span>
</span>
<span class="paragraph"><span class="string">There is one respect, however, in which Gruber's rule is more liberal
than the one given here, since it allows blank lines to occur inside
an HTML block.  There are two reasons for disallowing them here.
First, it removes the need to parse balanced tags, which is
expensive and can require backtracking from the end of the document
if no matching end tag is found. Second, it provides a very simple
and flexible way of including Markdown content inside HTML tags:
simply separate the Markdown from the HTML using blank lines:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;div&gt;

*Emphasized*␣text.

&lt;/div&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;div&gt;
&lt;p&gt;&lt;em&gt;Emphasized&lt;/em&gt;␣text.&lt;/p&gt;
&lt;/div&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Compare:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;div&gt;
*Emphasized*␣text.
&lt;/div&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;div&gt;
*Emphasized*␣text.
&lt;/div&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Some Markdown implementations have adopted a convention of
interpreting content inside tags as text if the open tag has
the attribute </span><span class="code">`markdown=1`</span><span class="string">.  The rule given above seems a simpler and
more elegant way of achieving the same expressive power, which is also
much simpler to parse.</span>
</span>
<span class="paragraph"><span class="string">The main potential drawback is that one can no longer paste HTML
blocks into Markdown documents with 100% reliability.  However,
</span><span class="emphasis">*<span class="string">in most cases</span>*</span><span class="string"> this will work fine, because the blank lines in
HTML are usually followed by HTML block tags.  For example:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;table&gt;

&lt;tr&gt;

&lt;td&gt;
Hi
&lt;/td&gt;

&lt;/tr&gt;

&lt;/table&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;table&gt;
&lt;tr&gt;
&lt;td&gt;
Hi
&lt;/td&gt;
&lt;/tr&gt;
&lt;/table&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Moreover, blank lines are usually not necessary and can be
deleted.  The exception is inside </span><span class="code">`&lt;pre&gt;`</span><span class="string"> tags; here, one can
replace the blank lines with </span><span class="code">`&amp;#10;`</span><span class="string"> entities.</span>
</span>
<span class="paragraph"><span class="string">So there is no important loss of expressive power with the new rule.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;link-reference-definitions&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.7 Link reference definitions</span></span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">link reference definition</span>](<span class="destination">@link-reference-definition</span>)</span><span class="string">
consists of a </span><span class="link">[<span class="string">link label</span>]</span><span class="string">, indented up to three spaces, followed
by a colon (</span><span class="code">`:`</span><span class="string">), optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> (including up to one
</span><span class="link">[<span class="string">line ending</span>]</span><span class="string">), a </span><span class="link">[<span class="string">link destination</span>]</span><span class="string">,
optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> (including up to one
</span><span class="link">[<span class="string">line ending</span>]</span><span class="string">), and an optional </span><span class="link">[<span class="string">link
title</span>]</span><span class="string">, which if it is present must be separated
from the </span><span class="link">[<span class="string">link destination</span>]</span><span class="string"> by </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">.
No further </span><span class="link">[<span class="string">non-space character</span>]</span><span class="string">s may occur on the line.</span>
</span>
<span class="paragraph"><span class="string">A [<span class="string">link reference-definition</span>]
does not correspond to a structural element of a document.  Instead, it
defines a label which can be used in </span><span class="link">[<span class="string">reference link</span>]</span><span class="string">s
and reference-style </span><span class="link">[<span class="string">images</span>]</span><span class="string"> elsewhere in the document.  </span><span class="link">[<span class="string">Link
reference definitions</span>]</span><span class="string"> can come either before or after the links that use
them.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]:␣/url␣&quot;title&quot;

[foo]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣[foo]:␣
␣␣␣␣␣␣/url␣␣
␣␣␣␣␣␣␣␣␣␣␣'the␣title'␣␣

[foo]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;the␣title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[Foo*bar\]]:my_(url)␣'title␣(with␣parens)'

[Foo*bar\]]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;my_(url)&quot;␣title=&quot;title␣(with␣parens)&quot;&gt;Foo*bar]&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[Foo␣bar]:
&lt;my␣url&gt;
'title'

[Foo␣bar]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;my%20url&quot;␣title=&quot;title&quot;&gt;Foo␣bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The title may be omitted:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]:
/url

[foo]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The link destination may not be omitted:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]:

[foo]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo]:&lt;/p&gt;
&lt;p&gt;[foo]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A link can come before its corresponding definition:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]

[foo]:␣url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;url&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If there are several matching definitions, the first one takes
precedence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]

[foo]:␣first
[foo]:␣second
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;first&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">As noted in the section on </span><span class="link">[<span class="string">Links</span>]</span><span class="string">, matching of labels is
case-insensitive (see </span><span class="link">[<span class="string">matches</span>]</span><span class="string">).</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[FOO]:␣/url

[Foo]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;&gt;Foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[ΑΓΩ]:␣/φου

[αγω]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/%CF%86%CE%BF%CF%85&quot;&gt;αγω&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here is a link reference definition with no corresponding link.
It contributes nothing to the document.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not a link reference definition, because there are
</span><span class="link">[<span class="string">non-space character</span>]</span><span class="string">s after the title:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]:␣/url␣&quot;title&quot;␣ok
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo]:␣/url␣&amp;quot;title&amp;quot;␣ok&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not a link reference definition, because it is indented
four spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣[foo]:␣/url␣&quot;title&quot;

[foo]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;[foo]:␣/url␣&amp;quot;title&amp;quot;
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;[foo]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not a link reference definition, because it occurs inside
a code block:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```
[foo]:␣/url
```

[foo]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;[foo]:␣/url
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;[foo]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">link reference definition</span>]</span><span class="string"> cannot interrupt a paragraph.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
[bar]:␣/baz

[bar]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo
[bar]:␣/baz&lt;/p&gt;
&lt;p&gt;[bar]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, it can directly follow other block elements, such as headers
and horizontal rules, and it need not be followed by a blank line.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
#␣[Foo]
[foo]:␣/url
&gt;␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h1&gt;&lt;a␣href=&quot;/url&quot;&gt;Foo&lt;/a&gt;&lt;/h1&gt;
&lt;blockquote&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Several </span><span class="link">[<span class="string">link reference definition</span>]</span><span class="string">s
can occur one after another, without intervening blank lines.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]:␣/foo-url␣&quot;foo&quot;
[bar]:␣/bar-url
␣␣&quot;bar&quot;
[baz]:␣/baz-url

[foo],
[bar],
[baz]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/foo-url&quot;␣title=&quot;foo&quot;&gt;foo&lt;/a&gt;,
&lt;a␣href=&quot;/bar-url&quot;␣title=&quot;bar&quot;&gt;bar&lt;/a&gt;,
&lt;a␣href=&quot;/baz-url&quot;&gt;baz&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="link">[<span class="string">Link reference definition</span>]</span><span class="string">s can occur
inside block containers, like lists and block quotations.  They
affect the entire document, not just the container in which they
are defined:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]

&gt;␣[foo]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>

<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;paragraphs&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.8 Paragraphs</span></span>
</span>
<span class="paragraph"><span class="string">A sequence of non-blank lines that cannot be interpreted as other
kinds of blocks forms a </span><span class="link">[<span class="string">paragraph</span>](<span class="destination">@paragraph</span>)</span><span class="string">.
The contents of the paragraph are the result of parsing the
paragraph's raw content as inlines.  The paragraph's raw content
is formed by concatenating the lines and removing initial and final
</span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A simple example with two paragraphs:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
aaa

bbb
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aaa&lt;/p&gt;
&lt;p&gt;bbb&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Paragraphs can contain multiple lines, but no blank lines:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
aaa
bbb

ccc
ddd
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aaa
bbb&lt;/p&gt;
&lt;p&gt;ccc
ddd&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Multiple blank lines between paragraph have no effect:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
aaa


bbb
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aaa&lt;/p&gt;
&lt;p&gt;bbb&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Leading spaces are skipped:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣aaa
␣bbb
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aaa
bbb&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Lines after the first may be indented any amount, since indented
code blocks cannot interrupt paragraphs.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
aaa
␣␣␣␣␣␣␣␣␣␣␣␣␣bbb
␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣␣ccc
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aaa
bbb
ccc&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, the first line may be indented at most three spaces,
or an indented code block will be triggered:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣aaa
bbb
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aaa
bbb&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣aaa
bbb
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;aaa
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;bbb&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Final spaces are stripped before inline parsing, so a paragraph
that ends with two or more spaces will not end with a </span><span class="link">[<span class="string">hard line
break</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
aaa␣␣␣␣␣
bbb␣␣␣␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aaa&lt;br␣/&gt;
bbb&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;blank-lines&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 4.9 Blank lines</span></span>
</span>
<span class="paragraph"><span class="link">[<span class="string">Blank line</span>]</span><span class="string">s between block-level elements are ignored,
except for the role they play in determining whether a </span><span class="link">[<span class="string">list</span>]</span><span class="string">
is </span><span class="link">[<span class="string">tight</span>]</span><span class="string"> or </span><span class="link">[<span class="string">loose</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">Blank lines at the beginning and end of the document are also ignored.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣

aaa
␣␣

#␣aaa

␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aaa&lt;/p&gt;
&lt;h1&gt;aaa&lt;/h1&gt;
`````````````````````````````````````````````````````````
</span>

<span class="atx header"># <span class="content"><span class="html">&lt;a id=&quot;container-blocks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 5 Container blocks</span></span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">container block</span>]</span><span class="string"> is a block that has other
blocks as its contents.  There are two basic kinds of container blocks:
</span><span class="link">[<span class="string">block quotes</span>]</span><span class="string"> and </span><span class="link">[<span class="string">list items</span>]</span><span class="string">.
</span><span class="link">[<span class="string">Lists</span>]</span><span class="string"> are meta-containers for </span><span class="link">[<span class="string">list items</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">We define the syntax for container blocks recursively.  The general
form of the definition is:</span>
</span>
<span class="quote block">&gt; <span class="content"><span class="paragraph"><span class="string">If X is a sequence of blocks, then the result of
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">transforming X in such-and-such a way is a container of type Y
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">with these blocks as its content.</span>
</span></span></span>
<span class="paragraph"><span class="string">So, we explain what counts as a block quote or list item by explaining
how these can be </span><span class="emphasis">*<span class="string">generated</span>*</span><span class="string"> from their contents. This should suffice
to define the syntax, although it does not give a recipe for </span><span class="emphasis">*<span class="string">parsing</span>*</span><span class="string">
these constructions.  (A recipe is provided below in the section entitled
</span><span class="link">[<span class="string">A parsing strategy</span>](<span class="destination">#appendix-a-a-parsing-strategy</span>)</span><span class="string">.)</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;block-quotes&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 5.1 Block quotes</span></span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">block quote marker</span>](<span class="destination">@block-quote-marker</span>)</span><span class="string">
consists of 0-3 spaces of initial indent, plus (a) the character </span><span class="code">`&gt;`</span><span class="string"> together
with a following space, or (b) a single character </span><span class="code">`&gt;`</span><span class="string"> not followed by a space.</span>
</span>
<span class="paragraph"><span class="string">The following rules define </span><span class="link">[<span class="string">block quotes</span>]</span><span class="string">:</span>
</span>
<span class="list"><span class="list item">1.  <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">Basic case.</span>**</span><span class="string">  If a string of lines </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string"> constitute a sequence
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">of blocks </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string">, then the result of prepending a </span><span class="link">[<span class="string">block quote
</span></span></span></span>    <span class="content"><span class="paragraph"><span class="link"><span class="string">marker</span>]</span><span class="string"> to the beginning of each line in </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">is a </span><span class="link">[<span class="string">block quote</span>](<span class="destination">#block-quotes</span>)</span><span class="string"> containing </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string">.</span>
</span></span>
</span><span class="list item">2.  <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">Laziness.</span>**</span><span class="string">  If a string of lines </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string"> constitute a </span><span class="link">[<span class="string">block
</span></span></span></span>    <span class="content"><span class="paragraph"><span class="link"><span class="string">quote</span>](<span class="destination">#block-quotes</span>)</span><span class="string"> with contents </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string">, then the result of deleting
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">the initial </span><span class="link">[<span class="string">block quote marker</span>]</span><span class="string"> from one or
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">more lines in which the next </span><span class="link">[<span class="string">non-space character</span>]</span><span class="string"> after the </span><span class="link">[<span class="string">block
</span></span></span></span>    <span class="content"><span class="paragraph"><span class="link"><span class="string">quote marker</span>]</span><span class="string"> is </span><span class="link">[<span class="string">paragraph continuation
</span></span></span></span>    <span class="content"><span class="paragraph"><span class="link"><span class="string">text</span>]</span><span class="string"> is a block quote with </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string"> as its content.
</span></span></span>    <span class="content"><span class="paragraph"><span class="link">[<span class="string">Paragraph continuation text</span>](<span class="destination">@paragraph-continuation-text</span>)</span><span class="string"> is text
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">that will be parsed as part of the content of a paragraph, but does
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">not occur at the beginning of the paragraph.</span>
</span></span>
</span><span class="list item">3.  <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">Consecutiveness.</span>**</span><span class="string">  A document cannot contain two </span><span class="link">[<span class="string">block
</span></span></span></span>    <span class="content"><span class="paragraph"><span class="link"><span class="string">quotes</span>]</span><span class="string"> in a row unless there is a </span><span class="link">[<span class="string">blank line</span>]</span><span class="string"> between them.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">Nothing else counts as a </span><span class="link">[<span class="string">block quote</span>](<span class="destination">#block-quotes</span>)</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">Here is a simple example:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣#␣Foo
&gt;␣bar
&gt;␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;h1&gt;Foo&lt;/h1&gt;
&lt;p&gt;bar
baz&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The spaces after the </span><span class="code">`&gt;`</span><span class="string"> characters can be omitted:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;#␣Foo
&gt;bar
&gt;␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;h1&gt;Foo&lt;/h1&gt;
&lt;p&gt;bar
baz&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The </span><span class="code">`&gt;`</span><span class="string"> characters can be indented 1-3 spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣&gt;␣#␣Foo
␣␣␣&gt;␣bar
␣&gt;␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;h1&gt;Foo&lt;/h1&gt;
&lt;p&gt;bar
baz&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Four spaces gives us a code block:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣&gt;␣#␣Foo
␣␣␣␣&gt;␣bar
␣␣␣␣&gt;␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;&amp;gt;␣#␣Foo
&amp;gt;␣bar
&amp;gt;␣baz
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The Laziness clause allows us to omit the </span><span class="code">`&gt;`</span><span class="string"> before a
paragraph continuation line:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣#␣Foo
&gt;␣bar
baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;h1&gt;Foo&lt;/h1&gt;
&lt;p&gt;bar
baz&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A block quote can contain some lazy and some non-lazy
continuation lines:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣bar
baz
&gt;␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;bar
baz
foo&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Laziness only applies to lines that are continuations of
paragraphs. Lines containing characters or indentation that indicate
block structure cannot be lazy.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣foo
---
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣-␣foo
-␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;ul&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣␣␣␣␣foo
␣␣␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;foo
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;bar
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣```
foo
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A block quote can be empty:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;
&gt;␣␣
&gt;␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A block quote can have initial or final blank lines:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;
&gt;␣foo
&gt;␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A blank line always separates block quotes:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣foo

&gt;␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">(Most current Markdown implementations, including John Gruber's
original </span><span class="code">`Markdown.pl`</span><span class="string">, will parse this example as a single block quote
with two paragraphs.  But it seems better to allow the author to decide
whether two block quotes or one are wanted.)</span>
</span>
<span class="paragraph"><span class="string">Consecutiveness means that if we put these block quotes together,
we get a single block quote:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣foo
&gt;␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;foo
bar&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">To get a block quote with two paragraphs, use:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣foo
&gt;
&gt;␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Block quotes can interrupt paragraphs:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo
&gt;␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">In general, blank lines are not needed before or after block
quotes:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣aaa
***
&gt;␣bbb
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;aaa&lt;/p&gt;
&lt;/blockquote&gt;
&lt;hr␣/&gt;
&lt;blockquote&gt;
&lt;p&gt;bbb&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, because of laziness, a blank line is needed between
a block quote and a following paragraph:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣bar
baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;bar
baz&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣bar

baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣bar
&gt;
baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">It is a consequence of the Laziness rule that any number
of initial </span><span class="code">`&gt;`</span><span class="string">s may be omitted on a continuation line of a
nested block quote:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣&gt;␣&gt;␣foo
bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;foo
bar&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;&gt;&gt;␣foo
&gt;␣bar
&gt;&gt;baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;foo
bar
baz&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">When including an indented code block in a block quote,
remember that the </span><span class="link">[<span class="string">block quote marker</span>]</span><span class="string"> includes
both the </span><span class="code">`&gt;`</span><span class="string"> and a following space.  So </span><span class="emphasis">*<span class="string">five spaces</span>*</span><span class="string"> are needed after
the </span><span class="code">`&gt;`</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣␣␣␣␣code

&gt;␣␣␣␣not␣code
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;pre&gt;&lt;code&gt;code
&lt;/code&gt;&lt;/pre&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;not␣code&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>

<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;list-items&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 5.2 List items</span></span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">list marker</span>](<span class="destination">@list-marker</span>)</span><span class="string"> is a
</span><span class="link">[<span class="string">bullet list marker</span>]</span><span class="string"> or an </span><span class="link">[<span class="string">ordered list marker</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">bullet list marker</span>](<span class="destination">@bullet-list-marker</span>)</span><span class="string">
is a </span><span class="code">`-`</span><span class="string">, </span><span class="code">`+`</span><span class="string">, or </span><span class="code">`*`</span><span class="string"> character.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">ordered list marker</span>](<span class="destination">@ordered-list-marker</span>)</span><span class="string">
is a sequence of one of more digits (</span><span class="code">`0-9`</span><span class="string">), followed by either a
</span><span class="code">`.`</span><span class="string"> character or a </span><span class="code">`)`</span><span class="string"> character.</span>
</span>
<span class="paragraph"><span class="string">The following rules define </span><span class="link">[<span class="string">list items</span>]</span><span class="string">:</span>
</span>
<span class="list"><span class="list item">1.  <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">Basic case.</span>**</span><span class="string">  If a sequence of lines </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string"> constitute a sequence of
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">blocks </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string"> starting with a </span><span class="link">[<span class="string">non-space character</span>]</span><span class="string"> and not separated
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">from each other by more than one blank line, and </span><span class="emphasis">*<span class="string">M</span>*</span><span class="string"> is a list
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">marker </span><span class="emphasis">*<span class="string">M</span>*</span><span class="string"> of width </span><span class="emphasis">*<span class="string">W</span>*</span><span class="string"> followed by 0 &lt; </span><span class="emphasis">*<span class="string">N</span>*</span><span class="string"> &lt; 5 spaces, then the result
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">of prepending </span><span class="emphasis">*<span class="string">M</span>*</span><span class="string"> and the following spaces to the first line of
</span></span></span>    <span class="content"><span class="paragraph"><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string">, and indenting subsequent lines of </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string"> by </span><span class="emphasis">*<span class="string">W + N</span>*</span><span class="string"> spaces, is a
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">list item with </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string"> as its contents.  The type of the list item
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">(bullet or ordered) is determined by the type of its list marker.
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">If the list item is ordered, then it is also assigned a start
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">number, based on the ordered list marker.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">For example, let </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string"> be the lines</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
A␣paragraph
with␣two␣lines.

␣␣␣␣indented␣code

&gt;␣A␣block␣quote.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;A␣paragraph
with␣two␣lines.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;A␣block␣quote.&lt;/p&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">And let </span><span class="emphasis">*<span class="string">M</span>*</span><span class="string"> be the marker </span><span class="code">`1.`</span><span class="string">, and </span><span class="emphasis">*<span class="string">N</span>*</span><span class="string"> = 2.  Then rule #1 says
that the following is an ordered list item with start number 1,
and the same contents as </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
1.␣␣A␣paragraph
␣␣␣␣with␣two␣lines.

␣␣␣␣␣␣␣␣indented␣code

␣␣␣␣&gt;␣A␣block␣quote.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;A␣paragraph
with␣two␣lines.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;A␣block␣quote.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The most important thing to notice is that the position of
the text after the list marker determines how much indentation
is needed in subsequent blocks in the list item.  If the list
marker takes up two spaces, and there are three spaces between
the list marker and the next </span><span class="link">[<span class="string">non-space character</span>]</span><span class="string">, then blocks
must be indented five spaces in order to fall under the list
item.</span>
</span>
<span class="paragraph"><span class="string">Here are some examples showing how far content must be indented to be
put under the list item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣one

␣two
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;two&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣one

␣␣two
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;one&lt;/p&gt;
&lt;p&gt;two&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣-␣␣␣␣one

␣␣␣␣␣two
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;␣two
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣-␣␣␣␣one

␣␣␣␣␣␣two
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;one&lt;/p&gt;
&lt;p&gt;two&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">It is tempting to think of this in terms of columns:  the continuation
blocks must be indented at least to the column of the first
</span><span class="link">[<span class="string">non-space character</span>]</span><span class="string"> after the list marker. However, that is not quite right.
The spaces after the list marker determine how much relative indentation
is needed.  Which column this indentation reaches will depend on
how the list item is embedded in other constructions, as shown by
this example:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣&gt;␣&gt;␣1.␣␣one
&gt;&gt;
&gt;&gt;␣␣␣␣␣two
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;one&lt;/p&gt;
&lt;p&gt;two&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here </span><span class="code">`two`</span><span class="string"> occurs in the same column as the list marker </span><span class="code">`1.`</span><span class="string">,
but is actually contained in the list item, because there is
sufficent indentation after the last containing blockquote marker.</span>
</span>
<span class="paragraph"><span class="string">The converse is also possible.  In the following example, the word </span><span class="code">`two`</span><span class="string">
occurs far to the right of the initial text of the list item, </span><span class="code">`one`</span><span class="string">, but
it is not considered part of the list item, because it is not indented
far enough past the blockquote marker:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;&gt;-␣one
&gt;&gt;
␣␣&gt;␣␣&gt;␣two
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;one&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;two&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A list item may not contain blocks that are separated by more than
one blank line.  Thus, two blank lines will end a list, unless the
two blanks are contained in a </span><span class="link">[<span class="string">fenced code block</span>]</span><span class="string">.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo

␣␣bar

-␣foo


␣␣bar

-␣```
␣␣foo


␣␣bar
␣␣```

-␣baz

␣␣+␣```
␣␣␣␣foo


␣␣␣␣bar
␣␣␣␣```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;foo


bar
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;baz&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;foo


bar
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A list item may contain any kind of block:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
1.␣␣foo

␣␣␣␣```
␣␣␣␣bar
␣␣␣␣```

␣␣␣␣baz

␣␣␣␣&gt;␣bam
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bar
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;baz&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;bam&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="list"><span class="list item">2.  <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">Item starting with indented code.</span>**</span><span class="string">  If a sequence of lines </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">constitute a sequence of blocks </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string"> starting with an indented code
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">block and not separated from each other by more than one blank line,
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">and </span><span class="emphasis">*<span class="string">M</span>*</span><span class="string"> is a list marker </span><span class="emphasis">*<span class="string">M</span>*</span><span class="string"> of width </span><span class="emphasis">*<span class="string">W</span>*</span><span class="string"> followed by
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">one space, then the result of prepending </span><span class="emphasis">*<span class="string">M</span>*</span><span class="string"> and the following
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">space to the first line of </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string">, and indenting subsequent lines of
</span></span></span>    <span class="content"><span class="paragraph"><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string"> by </span><span class="emphasis">*<span class="string">W + 1</span>*</span><span class="string"> spaces, is a list item with </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string"> as its contents.
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">If a line is empty, then it need not be indented.  The type of the
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">list item (bullet or ordered) is determined by the type of its list
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">marker.  If the list item is ordered, then it is also assigned a
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">start number, based on the ordered list marker.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">An indented code block will have to be indented four spaces beyond
the edge of the region where text will be included in the list item.
In the following case that is 6 spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo

␣␣␣␣␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bar
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">And in this case it is 11 spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣10.␣␣foo

␣␣␣␣␣␣␣␣␣␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol␣start=&quot;10&quot;&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;bar
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If the </span><span class="emphasis">*<span class="string">first</span>*</span><span class="string"> block in the list item is an indented code block,
then by rule #2, the contents must be indented </span><span class="emphasis">*<span class="string">one</span>*</span><span class="string"> space after the
list marker:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣indented␣code

paragraph

␣␣␣␣more␣code
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;paragraph&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;more␣code
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
1.␣␣␣␣␣indented␣code

␣␣␣paragraph

␣␣␣␣␣␣␣more␣code
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;paragraph&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;more␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that an additional space indent is interpreted as space
inside the code block:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
1.␣␣␣␣␣␣indented␣code

␣␣␣paragraph

␣␣␣␣␣␣␣more␣code
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;␣indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;paragraph&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;more␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that rules #1 and #2 only apply to two cases:  (a) cases
in which the lines to be included in a list item begin with a
</span><span class="link">[<span class="string">non-space character</span>]</span><span class="string">, and (b) cases in which
they begin with an indented code
block.  In a case like the following, where the first block begins with
a three-space indent, the rules do not allow us to form a list item by
indenting the whole thing and prepending a list marker:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣foo

bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;/p&gt;
&lt;p&gt;bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣␣␣␣foo

␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not a significant restriction, because when a block begins
with 1-3 spaces indent, the indentation can always be removed without
a change in interpretation, allowing rule #1 to be applied.  So, in
the above case:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣␣foo

␣␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="list"><span class="list item">3. <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">Empty list item.</span>**</span><span class="string">  A </span><span class="link">[<span class="string">list marker</span>]</span><span class="string"> followed by a
</span></span></span><span class="content"><span class="paragraph"><span class="string">line containing only </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> is a list item with no contents.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">Here is an empty bullet list item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
-
-␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">It does not matter whether there are spaces following the </span><span class="link">[<span class="string">list marker</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
-␣␣␣
-␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here is an empty ordered list item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
1.␣foo
2.
3.␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A list may start or end with an empty list item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="list"><span class="list item">4.  <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">Indentation.</span>**</span><span class="string">  If a sequence of lines </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string"> constitutes a list item
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">according to rule #1, #2, or #3, then the result of indenting each line
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">of </span><span class="emphasis">*<span class="string">L</span>*</span><span class="string"> by 1-3 spaces (the same for each line) also constitutes a
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">list item with the same contents and attributes.  If a line is
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">empty, then it need not be indented.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">Indented one space:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣1.␣␣A␣paragraph
␣␣␣␣␣with␣two␣lines.

␣␣␣␣␣␣␣␣␣indented␣code

␣␣␣␣␣&gt;␣A␣block␣quote.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;A␣paragraph
with␣two␣lines.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;A␣block␣quote.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Indented two spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣1.␣␣A␣paragraph
␣␣␣␣␣␣with␣two␣lines.

␣␣␣␣␣␣␣␣␣␣indented␣code

␣␣␣␣␣␣&gt;␣A␣block␣quote.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;A␣paragraph
with␣two␣lines.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;A␣block␣quote.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Indented three spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣1.␣␣A␣paragraph
␣␣␣␣␣␣␣with␣two␣lines.

␣␣␣␣␣␣␣␣␣␣␣indented␣code

␣␣␣␣␣␣␣&gt;␣A␣block␣quote.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;A␣paragraph
with␣two␣lines.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;A␣block␣quote.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Four spaces indent gives a code block:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣1.␣␣A␣paragraph
␣␣␣␣␣␣␣␣with␣two␣lines.

␣␣␣␣␣␣␣␣␣␣␣␣indented␣code

␣␣␣␣␣␣␣␣&gt;␣A␣block␣quote.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;1.␣␣A␣paragraph
␣␣␣␣with␣two␣lines.

␣␣␣␣␣␣␣␣indented␣code

␣␣␣␣&amp;gt;␣A␣block␣quote.
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>

<span class="list"><span class="list item">5.  <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">Laziness.</span>**</span><span class="string">  If a string of lines </span><span class="emphasis">*<span class="string">Ls</span>*</span><span class="string"> constitute a </span><span class="link">[<span class="string">list
</span></span></span></span>    <span class="content"><span class="paragraph"><span class="link"><span class="string">item</span>](<span class="destination">#list-items</span>)</span><span class="string"> with contents </span><span class="emphasis">*<span class="string">Bs</span>*</span><span class="string">, then the result of deleting
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">some or all of the indentation from one or more lines in which the
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">next </span><span class="link">[<span class="string">non-space character</span>]</span><span class="string"> after the indentation is
</span></span></span>    <span class="content"><span class="paragraph"><span class="link">[<span class="string">paragraph continuation text</span>]</span><span class="string"> is a
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">list item with the same contents and attributes.  The unindented
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">lines are called
</span></span></span>    <span class="content"><span class="paragraph"><span class="link">[<span class="string">lazy continuation line</span>](<span class="destination">@lazy-continuation-line</span>)</span><span class="string">s.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">Here is an example with </span><span class="link">[<span class="string">lazy continuation line</span>]</span><span class="string">s:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣1.␣␣A␣paragraph
with␣two␣lines.

␣␣␣␣␣␣␣␣␣␣indented␣code

␣␣␣␣␣␣&gt;␣A␣block␣quote.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;A␣paragraph
with␣two␣lines.&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;indented␣code
&lt;/code&gt;&lt;/pre&gt;
&lt;blockquote&gt;
&lt;p&gt;A␣block␣quote.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Indentation can be partially deleted:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣1.␣␣A␣paragraph
␣␣␣␣with␣two␣lines.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;A␣paragraph
with␣two␣lines.&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">These examples show how laziness can work in nested structures:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣1.␣&gt;␣Blockquote
continued␣here.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;blockquote&gt;
&lt;p&gt;Blockquote
continued␣here.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&gt;␣1.␣&gt;␣Blockquote
&gt;␣continued␣here.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;blockquote&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;blockquote&gt;
&lt;p&gt;Blockquote
continued␣here.&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;/blockquote&gt;
`````````````````````````````````````````````````````````
</span>

<span class="list"><span class="list item">6.  <span class="content"><span class="paragraph"><span class="emphasis">**<span class="string">That's all.</span>**</span><span class="string"> Nothing that is not counted as a list item by rules
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">#1--5 counts as a </span><span class="link">[<span class="string">list item</span>](<span class="destination">#list-items</span>)</span><span class="string">.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">The rules for sublists follow from the general rules above.  A sublist
must be indented the same number of spaces a paragraph would need to be
in order to be included in the list item.</span>
</span>
<span class="paragraph"><span class="string">So, in this case we need two spaces indent:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
␣␣-␣bar
␣␣␣␣-␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo
&lt;ul&gt;
&lt;li&gt;bar
&lt;ul&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">One is not enough:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
␣-␣bar
␣␣-␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here we need four, because the list marker is wider:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
10)␣foo
␣␣␣␣-␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol␣start=&quot;10&quot;&gt;
&lt;li&gt;foo
&lt;ul&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Three is not enough:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
10)␣foo
␣␣␣-␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol␣start=&quot;10&quot;&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ol&gt;
&lt;ul&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A list may be the first block in a list item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣-␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
1.␣-␣2.␣foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;ol␣start=&quot;2&quot;&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A list item can contain a header:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣#␣Foo
-␣Bar
␣␣---
␣␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;h1&gt;Foo&lt;/h1&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;h2&gt;Bar&lt;/h2&gt;
baz&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">### <span class="content"><span class="html">&lt;a id=&quot;motivation&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 5.2.1 Motivation</span></span>
</span>
<span class="paragraph"><span class="string">John Gruber's Markdown spec says the following about list items:</span>
</span>
<span class="list"><span class="list item">1. <span class="content"><span class="paragraph"><span class="string">&quot;List markers typically start at the left margin, but may be indented
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">by up to three spaces. List markers must be followed by one or more
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">spaces or a tab.&quot;</span>
</span></span>
</span><span class="list item">2. <span class="content"><span class="paragraph"><span class="string">&quot;To make lists look nice, you can wrap items with hanging indents....
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">But if you don't want to, you don't have to.&quot;</span>
</span></span>
</span><span class="list item">3. <span class="content"><span class="paragraph"><span class="string">&quot;List items may consist of multiple paragraphs. Each subsequent
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">paragraph in a list item must be indented by either 4 spaces or one
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">tab.&quot;</span>
</span></span>
</span><span class="list item">4. <span class="content"><span class="paragraph"><span class="string">&quot;It looks nice if you indent every line of the subsequent paragraphs,
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">but here again, Markdown will allow you to be lazy.&quot;</span>
</span></span>
</span><span class="list item">5. <span class="content"><span class="paragraph"><span class="string">&quot;To put a blockquote within a list item, the blockquote's </span><span class="code">`&gt;`</span><span class="string">
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">delimiters need to be indented.&quot;</span>
</span></span>
</span><span class="list item">6. <span class="content"><span class="paragraph"><span class="string">&quot;To put a code block within a list item, the code block needs to be
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">indented twice — 8 spaces or two tabs.&quot;</span>
</span></span></span></span>
<span class="paragraph"><span class="string">These rules specify that a paragraph under a list item must be indented
four spaces (presumably, from the left margin, rather than the start of
the list marker, but this is not said), and that code under a list item
must be indented eight spaces instead of the usual four.  They also say
that a block quote must be indented, but not by how much; however, the
example given has four spaces indentation.  Although nothing is said
about other kinds of block-level content, it is certainly reasonable to
infer that </span><span class="emphasis">*<span class="string">all</span>*</span><span class="string"> block elements under a list item, including other
lists, must be indented four spaces.  This principle has been called the
</span><span class="emphasis">*<span class="string">four-space rule</span>*</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">The four-space rule is clear and principled, and if the reference
implementation </span><span class="code">`Markdown.pl`</span><span class="string"> had followed it, it probably would have
become the standard.  However, </span><span class="code">`Markdown.pl`</span><span class="string"> allowed paragraphs and
sublists to start with only two spaces indentation, at least on the
outer level.  Worse, its behavior was inconsistent: a sublist of an
outer-level list needed two spaces indentation, but a sublist of this
sublist needed three spaces.  It is not surprising, then, that different
implementations of Markdown have developed very different rules for
determining what comes under a list item.  (Pandoc and python-Markdown,
for example, stuck with Gruber's syntax description and the four-space
rule, while discount, redcarpet, marked, PHP Markdown, and others
followed </span><span class="code">`Markdown.pl`</span><span class="string">'s behavior more closely.)</span>
</span>
<span class="paragraph"><span class="string">Unfortunately, given the divergences between implementations, there
is no way to give a spec for list items that will be guaranteed not
to break any existing documents.  However, the spec given here should
correctly handle lists formatted with either the four-space rule or
the more forgiving </span><span class="code">`Markdown.pl`</span><span class="string"> behavior, provided they are laid out
in a way that is natural for a human to read.</span>
</span>
<span class="paragraph"><span class="string">The strategy here is to let the width and indentation of the list marker
determine the indentation necessary for blocks to fall under the list
item, rather than having a fixed and arbitrary number.  The writer can
think of the body of the list item as a unit which gets indented to the
right enough to fit the list marker (and any indentation on the list
marker).  (The laziness rule, #5, then allows continuation lines to be
unindented if needed.)</span>
</span>
<span class="paragraph"><span class="string">This rule is superior, we claim, to any rule requiring a fixed level of
indentation from the margin.  The four-space rule is clear but
unnatural. It is quite unintuitive that</span>
</span>
<span class="fenced code block">``` markdown
- foo

  bar

  - baz
```
</span>
<span class="paragraph"><span class="string">should be parsed as two lists with an intervening paragraph,</span>
</span>
<span class="fenced code block">``` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
```
</span>
<span class="paragraph"><span class="string">as the four-space rule demands, rather than a single list,</span>
</span>
<span class="fenced code block">``` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
```
</span>
<span class="paragraph"><span class="string">The choice of four spaces is arbitrary.  It can be learned, but it is
not likely to be guessed, and it trips up beginners regularly.</span>
</span>
<span class="paragraph"><span class="string">Would it help to adopt a two-space rule?  The problem is that such
a rule, together with the rule allowing 1--3 spaces indentation of the
initial list marker, allows text that is indented </span><span class="emphasis">*<span class="string">less than</span>*</span><span class="string"> the
original list marker to be included in the list item. For example,
</span><span class="code">`Markdown.pl`</span><span class="string"> parses</span>
</span>
<span class="fenced code block">``` markdown
   - one

  two
```
</span>
<span class="paragraph"><span class="string">as a single list item, with </span><span class="code">`two`</span><span class="string"> a continuation paragraph:</span>
</span>
<span class="fenced code block">``` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;one&lt;/p&gt;
&lt;p&gt;two&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
```
</span>
<span class="paragraph"><span class="string">and similarly</span>
</span>
<span class="fenced code block">``` markdown
&gt;   - one
&gt;
&gt;  two
```
</span>
<span class="paragraph"><span class="string">as</span>
</span>
<span class="fenced code block">``` html
&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;one&lt;/p&gt;
&lt;p&gt;two&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
```
</span>
<span class="paragraph"><span class="string">This is extremely unintuitive.</span>
</span>
<span class="paragraph"><span class="string">Rather than requiring a fixed indent from the margin, we could require
a fixed indent (say, two spaces, or even one space) from the list marker (which
may itself be indented).  This proposal would remove the last anomaly
discussed.  Unlike the spec presented above, it would count the following
as a list item with a subparagraph, even though the paragraph </span><span class="code">`bar`</span><span class="string">
is not indented as far as the first paragraph </span><span class="code">`foo`</span><span class="string">:</span>
</span>
<span class="fenced code block">``` markdown
 10. foo

   bar  
```
</span>
<span class="paragraph"><span class="string">Arguably this text does read like a list item with </span><span class="code">`bar`</span><span class="string"> as a subparagraph,
which may count in favor of the proposal.  However, on this proposal indented
code would have to be indented six spaces after the list marker.  And this
would break a lot of existing Markdown, which has the pattern:</span>
</span>
<span class="fenced code block">``` markdown
1.  foo

        indented code
```
</span>
<span class="paragraph"><span class="string">where the code is indented eight spaces.  The spec above, by contrast, will
parse this text as expected, since the code block's indentation is measured
from the beginning of </span><span class="code">`foo`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">The one case that needs special treatment is a list item that </span><span class="emphasis">*<span class="string">starts</span>*</span><span class="string">
with indented code.  How much indentation is required in that case, since
we don't have a &quot;first paragraph&quot; to measure from?  Rule #2 simply stipulates
that in such cases, we require one space indentation from the list marker
(and then the normal four spaces for the indented code).  This will match the
four-space rule in cases where the list marker plus its initial indentation
takes four spaces (a common case), but diverge in other cases.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;lists&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 5.3 Lists</span></span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">list</span>](<span class="destination">@list</span>)</span><span class="string"> is a sequence of one or more
list items </span><span class="link">[<span class="string">of the same type</span>]</span><span class="string">.  The list items
may be separated by single </span><span class="link">[<span class="string">blank lines</span>]</span><span class="string">, but two
blank lines end all containing lists.</span>
</span>
<span class="paragraph"><span class="string">Two list items are </span><span class="link">[<span class="string">of the same type</span>](<span class="destination">@of-the-same-type</span>)</span><span class="string">
if they begin with a </span><span class="link">[<span class="string">list marker</span>]</span><span class="string"> of the same type.
Two list markers are of the
same type if (a) they are bullet list markers using the same character
(</span><span class="code">`-`</span><span class="string">, </span><span class="code">`+`</span><span class="string">, or </span><span class="code">`*`</span><span class="string">) or (b) they are ordered list numbers with the same
delimiter (either </span><span class="code">`.`</span><span class="string"> or </span><span class="code">`)`</span><span class="string">).</span>
</span>
<span class="paragraph"><span class="string">A list is an </span><span class="link">[<span class="string">ordered list</span>](<span class="destination">@ordered-list</span>)</span><span class="string">
if its constituent list items begin with
</span><span class="link">[<span class="string">ordered list marker</span>]</span><span class="string">s, and a
</span><span class="link">[<span class="string">bullet list</span>](<span class="destination">@bullet-list</span>)</span><span class="string"> if its constituent list
items begin with </span><span class="link">[<span class="string">bullet list marker</span>]</span><span class="string">s.</span>
</span>
<span class="paragraph"><span class="string">The </span><span class="link">[<span class="string">start number</span>](<span class="destination">@start-number</span>)</span><span class="string">
of an </span><span class="link">[<span class="string">ordered list</span>]</span><span class="string"> is determined by the list number of
its initial list item.  The numbers of subsequent list items are
disregarded.</span>
</span>
<span class="paragraph"><span class="string">A list is </span><span class="link">[<span class="string">loose</span>](<span class="destination">@loose</span>)</span><span class="string"> if it any of its constituent
list items are separated by blank lines, or if any of its constituent
list items directly contain two block-level elements with a blank line
between them.  Otherwise a list is </span><span class="link">[<span class="string">tight</span>](<span class="destination">@tight</span>)</span><span class="string">.
(The difference in HTML output is that paragraphs in a loose list are
wrapped in </span><span class="code">`&lt;p&gt;`</span><span class="string"> tags, while paragraphs in a tight list are not.)</span>
</span>
<span class="paragraph"><span class="string">Changing the bullet or ordered list delimiter starts a new list:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
-␣bar
+␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
1.␣foo
2.␣bar
3)␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ol&gt;
&lt;ol␣start=&quot;3&quot;&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">In CommonMark, a list can interrupt a paragraph. That is,
no blank line is needed to separate a paragraph from a following
list:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo
-␣bar
-␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="code">`Markdown.pl`</span><span class="string"> does not allow this, through fear of triggering a list
via a numeral in a hard-wrapped line:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
The␣number␣of␣windows␣in␣my␣house␣is
14.␣␣The␣number␣of␣doors␣is␣6.
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;The␣number␣of␣windows␣in␣my␣house␣is&lt;/p&gt;
&lt;ol␣start=&quot;14&quot;&gt;
&lt;li&gt;The␣number␣of␣doors␣is␣6.&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Oddly, </span><span class="code">`Markdown.pl`</span><span class="string"> </span><span class="emphasis">*<span class="string">does</span>*</span><span class="string"> allow a blockquote to interrupt a paragraph,
even though the same considerations might apply.  We think that the two
cases should be treated the same.  Here are two reasons for allowing
lists to interrupt paragraphs:</span>
</span>
<span class="paragraph"><span class="string">First, it is natural and not uncommon for people to start lists without
blank lines:</span>
</span>
<span class="indented code block">    I need to buy
    - new shoes
    - a coat
    - a plane ticket

</span><span class="paragraph"><span class="string">Second, we are attracted to a</span>
</span>
<span class="quote block">&gt; <span class="content"><span class="paragraph"><span class="link">[<span class="string">principle of uniformity</span>](<span class="destination">@principle-of-uniformity</span>)</span><span class="string">:
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">if a chunk of text has a certain
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">meaning, it will continue to have the same meaning when put into a
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">container block (such as a list item or blockquote).</span>
</span></span></span>
<span class="paragraph"><span class="string">(Indeed, the spec for </span><span class="link">[<span class="string">list items</span>]</span><span class="string"> and </span><span class="link">[<span class="string">block quotes</span>]</span><span class="string"> presupposes
this principle.) This principle implies that if</span>
</span>
<span class="indented code block">      * I need to buy
        - new shoes
        - a coat
        - a plane ticket

</span><span class="paragraph"><span class="string">is a list item containing a paragraph followed by a nested sublist,
as all Markdown implementations agree it is (though the paragraph
may be rendered without </span><span class="code">`&lt;p&gt;`</span><span class="string"> tags, since the list is &quot;tight&quot;),
then</span>
</span>
<span class="indented code block">    I need to buy
    - new shoes
    - a coat
    - a plane ticket

</span><span class="paragraph"><span class="string">by itself should be a paragraph followed by a nested sublist.</span>
</span>
<span class="paragraph"><span class="string">Our adherence to the </span><span class="link">[<span class="string">principle of uniformity</span>]</span><span class="string">
thus inclines us to think that there are two coherent packages:</span>
</span>
<span class="list"><span class="list item">1.  <span class="content"><span class="paragraph"><span class="string">Require blank lines before </span><span class="emphasis">*<span class="string">all</span>*</span><span class="string"> lists and blockquotes,
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">including lists that occur as sublists inside other list items.</span>
</span></span>
</span><span class="list item">2.  <span class="content"><span class="paragraph"><span class="string">Require blank lines in none of these places.</span>
</span></span></span></span>
<span class="paragraph"><span class="link">[<span class="string">reStructuredText</span>](<span class="destination">http://docutils.sourceforge.net/rst.html</span>)</span><span class="string"> takes
the first approach, for which there is much to be said.  But the second
seems more consistent with established practice with Markdown.</span>
</span>
<span class="paragraph"><span class="string">There can be blank lines between items, but two blank lines end
a list:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo

-␣bar


-␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">As illustrated above in the section on </span><span class="link">[<span class="string">list items</span>]</span><span class="string">,
two blank lines between blocks </span><span class="emphasis">*<span class="string">within</span>*</span><span class="string"> a list item will also end a
list:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo


␣␣bar
-␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Indeed, two blank lines will end </span><span class="emphasis">*<span class="string">all</span>*</span><span class="string"> containing lists:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
␣␣-␣bar
␣␣␣␣-␣baz


␣␣␣␣␣␣bim
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo
&lt;ul&gt;
&lt;li&gt;bar
&lt;ul&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;␣␣bim
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Thus, two blank lines can be used to separate consecutive lists of
the same type, or to separate a list from an indented code block
that would otherwise be parsed as a subparagraph of the final list
item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣foo
-␣bar


-␣baz
-␣bim
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;foo&lt;/li&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
&lt;ul&gt;
&lt;li&gt;baz&lt;/li&gt;
&lt;li&gt;bim&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣␣␣foo

␣␣␣␣notcode

-␣␣␣foo


␣␣␣␣code
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;p&gt;notcode&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre&gt;&lt;code&gt;code
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">List items need not be indented to the same level.  The following
list items will be treated as items at the same list level,
since none is indented enough to belong to the previous list
item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
␣-␣b
␣␣-␣c
␣␣␣-␣d
␣␣-␣e
␣-␣f
-␣g
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;a&lt;/li&gt;
&lt;li&gt;b&lt;/li&gt;
&lt;li&gt;c&lt;/li&gt;
&lt;li&gt;d&lt;/li&gt;
&lt;li&gt;e&lt;/li&gt;
&lt;li&gt;f&lt;/li&gt;
&lt;li&gt;g&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is a loose list, because there is a blank line between
two of the list items:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
-␣b

-␣c
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;a&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;b&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;c&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">So is this, with a empty second item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*␣a
*

*␣c
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;a&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;c&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">These are loose lists, even though there is no space between the items,
because one of the items directly contains two block-level elements
with a blank line between them:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
-␣b

␣␣c
-␣d
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;a&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;b&lt;/p&gt;
&lt;p&gt;c&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;d&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
-␣b

␣␣[ref]:␣/url
-␣d
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;a&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;b&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;d&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is a tight list, because the blank lines are in a code block:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
-␣```
␣␣b


␣␣```
-␣c
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;a&lt;/li&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;b


&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;c&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is a tight list, because the blank line is between two
paragraphs of a sublist.  So the sublist is loose while
the outer list is tight:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
␣␣-␣b

␣␣␣␣c
-␣d
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;a
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;b&lt;/p&gt;
&lt;p&gt;c&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;d&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is a tight list, because the blank line is inside the
block quote:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*␣a
␣␣&gt;␣b
␣␣&gt;
*␣c
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;a
&lt;blockquote&gt;
&lt;p&gt;b&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;li&gt;c&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This list is tight, because the consecutive block elements
are not separated by blank lines:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
␣␣&gt;␣b
␣␣```
␣␣c
␣␣```
-␣d
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;a
&lt;blockquote&gt;
&lt;p&gt;b&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre&gt;&lt;code&gt;c
&lt;/code&gt;&lt;/pre&gt;
&lt;/li&gt;
&lt;li&gt;d&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A single-paragraph list is tight:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;a&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
␣␣-␣b
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;a
&lt;ul&gt;
&lt;li&gt;b&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This list is loose, because of the blank line between the
two block elements in the list item:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
1.␣```
␣␣␣foo
␣␣␣```

␣␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ol&gt;
&lt;li&gt;
&lt;pre&gt;&lt;code&gt;foo
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;bar&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here the outer list is loose, the inner list tight:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*␣foo
␣␣*␣bar

␣␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;foo&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;bar&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;baz&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
-␣a
␣␣-␣b
␣␣-␣c

-␣d
␣␣-␣e
␣␣-␣f
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;a&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;b&lt;/li&gt;
&lt;li&gt;c&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;d&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;e&lt;/li&gt;
&lt;li&gt;f&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;/ul&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header"># <span class="content"><span class="html">&lt;a id=&quot;inlines&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6 Inlines</span></span>
</span>
<span class="paragraph"><span class="string">Inlines are parsed sequentially from the beginning of the character
stream to the end (left to right, in left-to-right languages).
Thus, for example, in</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`hi`lo`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;hi&lt;/code&gt;lo`&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="code">`hi`</span><span class="string"> is parsed as code, leaving the backtick at the end as a literal
backtick.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;backslash-escapes&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.1 Backslash escapes</span></span>
</span>
<span class="paragraph"><span class="string">Any ASCII punctuation character may be backslash-escaped:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\!\&quot;\#\$\%\&amp;\'\(\)\*\+\,\-\.\/\:\;\&lt;\=\&gt;\?\@\[\\\]\^\_\`\{\|\}\~
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;!&amp;quot;#$%&amp;amp;'()*+,-./:;&amp;lt;=&amp;gt;?@[\]^_`{|}~&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Backslashes before other characters are treated as literal
backslashes:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\→\A\a\␣\3\φ\«
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;\␣␣␣\A\a\␣\3\φ\«&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Escaped characters are treated as regular characters and do
not have their usual Markdown meanings:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\*not␣emphasized*
\&lt;br/&gt;␣not␣a␣tag
\[not␣a␣link](/foo)
\`not␣code`
1\.␣not␣a␣list
\*␣not␣a␣list
\#␣not␣a␣header
\[foo]:␣/url␣&quot;not␣a␣reference&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*not␣emphasized*
&amp;lt;br/&amp;gt;␣not␣a␣tag
[not␣a␣link](/foo)
`not␣code`
1.␣not␣a␣list
*␣not␣a␣list
#␣not␣a␣header
[foo]:␣/url␣&amp;quot;not␣a␣reference&amp;quot;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If a backslash is itself escaped, the following character is not:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\\*emphasis*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;\&lt;em&gt;emphasis&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A backslash at the end of the line is a </span><span class="link">[<span class="string">hard line break</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo\
bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;br␣/&gt;
bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Backslash escapes do not work in code blocks, code spans, autolinks, or
raw HTML:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
``␣\[\`␣``
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;\[\`&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣\[\]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;\[\]
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
~~~
\[\]
~~~
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;\[\]
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;http://example.com?find=\*&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;http://example.com?find=%5C*&quot;&gt;http://example.com?find=\*&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;/bar\/)&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/bar\/)&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">But they work in all other contexts, including URLs and link titles,
link references, and </span><span class="link">[<span class="string">info string</span>]</span><span class="string">s in </span><span class="link">[<span class="string">fenced code block</span>]</span><span class="string">s:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo](/bar\*␣&quot;ti\*tle&quot;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/bar*&quot;␣title=&quot;ti*tle&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]

[foo]:␣/bar\*␣&quot;ti\*tle&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/bar*&quot;␣title=&quot;ti*tle&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```␣foo\+bar
foo
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code␣class=&quot;language-foo+bar&quot;&gt;foo
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>

<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;entities&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.2 Entities</span></span>
</span>
<span class="paragraph"><span class="string">With the goal of making this standard as HTML-agnostic as possible, all
valid HTML entities (except in code blocks and code spans)
are recognized as such and converted into unicode characters before
they are stored in the AST. This means that renderers to formats other
than HTML need not be HTML-entity aware.  HTML renderers may either escape
unicode characters as entities or leave them as they are.  (However,
</span><span class="code">`&quot;`</span><span class="string">, </span><span class="code">`&amp;`</span><span class="string">, </span><span class="code">`&lt;`</span><span class="string">, and </span><span class="code">`&gt;`</span><span class="string"> must always be rendered as entities.)</span>
</span>
<span class="paragraph"><span class="link">[<span class="string">Named entities</span>](<span class="destination">@name-entities</span>)</span><span class="string"> consist of </span><span class="code">`&amp;`</span>
</span><span class="list"><span class="list item">+ <span class="content"><span class="paragraph"><span class="string">any of the valid HTML5 entity names + </span><span class="code">`;`</span><span class="string">. The
</span></span></span><span class="content"><span class="paragraph"><span class="link">[<span class="string">following document</span>](<span class="destination">https://html.spec.whatwg.org/multipage/entities.json</span>)</span><span class="string">
</span></span></span><span class="content"><span class="paragraph"><span class="string">is used as an authoritative source of the valid entity names and their
</span></span></span><span class="content"><span class="paragraph"><span class="string">corresponding codepoints.</span>
</span></span></span></span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&amp;nbsp;␣&amp;amp;␣&amp;copy;␣&amp;AElig;␣&amp;Dcaron;␣&amp;frac34;␣&amp;HilbertSpace;␣&amp;DifferentialD;␣&amp;ClockwiseContourIntegral;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt; ␣&amp;amp;␣©␣Æ␣Ď␣¾␣ℋ␣ⅆ␣∲&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="link">[<span class="string">Decimal entities</span>](<span class="destination">@decimal-entities</span>)</span><span class="string">
consist of </span><span class="code">`&amp;#`</span><span class="string"> + a string of 1--8 arabic digits + </span><span class="code">`;`</span><span class="string">. Again, these
entities need to be recognised and tranformed into their corresponding
UTF8 codepoints. Invalid Unicode codepoints will be written as the
&quot;unknown codepoint&quot; character (</span><span class="code">`0xFFFD`</span><span class="string">)</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&amp;#35;␣&amp;#1234;␣&amp;#992;␣&amp;#98765432;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;#␣Ӓ␣Ϡ␣�&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="link">[<span class="string">Hexadecimal entities</span>](<span class="destination">@hexadecimal-entities</span>)</span><span class="string">
consist of </span><span class="code">`&amp;#`</span><span class="string"> + either </span><span class="code">`X`</span><span class="string"> or </span><span class="code">`x`</span><span class="string"> + a string of 1-8 hexadecimal digits</span>
</span><span class="list"><span class="list item">+ <span class="content"><span class="paragraph"><span class="code">`;`</span><span class="string">. They will also be parsed and turned into their corresponding UTF8 values in the AST.</span>
</span></span></span></span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&amp;#X22;␣&amp;#XD06;␣&amp;#xcab;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;quot;␣ആ␣ಫ&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here are some nonentities:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&amp;nbsp␣&amp;x;␣&amp;#;␣&amp;#x;␣&amp;ThisIsWayTooLongToBeAnEntityIsntIt;␣&amp;hi?;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;amp;nbsp␣&amp;amp;x;␣&amp;amp;#;␣&amp;amp;#x;␣&amp;amp;ThisIsWayTooLongToBeAnEntityIsntIt;␣&amp;amp;hi?;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Although HTML5 does accept some entities without a trailing semicolon
(such as </span><span class="code">`&amp;copy`</span><span class="string">), these are not recognized as entities here, because it
makes the grammar too ambiguous:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&amp;copy
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;amp;copy&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Strings that are not on the list of HTML5 named entities are not
recognized as entities either:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&amp;MadeUpEntity;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;amp;MadeUpEntity;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Entities are recognized in any context besides code spans or
code blocks, including raw HTML, URLs, </span><span class="link">[<span class="string">link title</span>]</span><span class="string">s, and
</span><span class="link">[<span class="string">fenced code block</span>] [info string]</span><span class="string">s:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;&amp;ouml;&amp;ouml;.html&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;&amp;ouml;&amp;ouml;.html&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo](/f&amp;ouml;&amp;ouml;␣&quot;f&amp;ouml;&amp;ouml;&quot;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/f%C3%B6%C3%B6&quot;␣title=&quot;föö&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]

[foo]:␣/f&amp;ouml;&amp;ouml;␣&quot;f&amp;ouml;&amp;ouml;&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/f%C3%B6%C3%B6&quot;␣title=&quot;föö&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```␣f&amp;ouml;&amp;ouml;
foo
```
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code␣class=&quot;language-föö&quot;&gt;foo
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Entities are treated as literal text in code spans and code blocks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`f&amp;ouml;&amp;ouml;`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;f&amp;amp;ouml;&amp;amp;ouml;&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
␣␣␣␣f&amp;ouml;f&amp;ouml;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;pre&gt;&lt;code&gt;f&amp;amp;ouml;f&amp;amp;ouml;
&lt;/code&gt;&lt;/pre&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;code-spans&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.3 Code spans</span></span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">backtick string</span>](<span class="destination">@backtick-string</span>)</span><span class="string">
is a string of one or more backtick characters (</span><span class="code">`` ` ``</span><span class="string">) that is neither
preceded nor followed by a backtick.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">code span</span>](<span class="destination">@code-span</span>)</span><span class="string"> begins with a backtick string and ends with
a backtick string of equal length.  The contents of the code span are
the characters between the two backtick strings, with leading and
trailing spaces and </span><span class="link">[<span class="string">line ending</span>]</span><span class="string">s removed, and
</span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> collapsed to single spaces.</span>
</span>
<span class="paragraph"><span class="string">This is a simple code span:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`foo`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;foo&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here two backticks are used, because the code contains a backtick.
This example also illustrates stripping of leading and trailing spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
``␣foo␣`␣bar␣␣``
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;foo␣`␣bar&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This example shows the motivation for stripping leading and trailing
spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`␣``␣`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;``&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="link">[<span class="string">Line ending</span>]</span><span class="string">s are treated like spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
``
foo
``
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;foo&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Interior spaces and </span><span class="link">[<span class="string">line ending</span>]</span><span class="string">s are collapsed into
single spaces, just as they would be by a browser:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`foo␣␣␣bar
␣␣baz`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;foo␣bar␣baz&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Q: Why not just leave the spaces, since browsers will collapse them
anyway?  A:  Because we might be targeting a non-HTML format, and we
shouldn't rely on HTML-specific rendering assumptions.</span>
</span>
<span class="paragraph"><span class="string">(Existing implementations differ in their treatment of internal
spaces and </span><span class="link">[<span class="string">line ending</span>]</span><span class="string">s.  Some, including </span><span class="code">`Markdown.pl`</span><span class="string"> and
</span><span class="code">`showdown`</span><span class="string">, convert an internal </span><span class="link">[<span class="string">line ending</span>]</span><span class="string"> into a
</span><span class="code">`&lt;br /&gt;`</span><span class="string"> tag.  But this makes things difficult for those who like to
hard-wrap their paragraphs, since a line break in the midst of a code
span will cause an unintended line break in the output.  Others just
leave internal spaces as they are, which is fine if only HTML is being
targeted.)</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`foo␣``␣bar`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;foo␣``␣bar&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that backslash escapes do not work in code spans. All backslashes
are treated literally:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`foo\`bar`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;foo\&lt;/code&gt;bar`&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Backslash escapes are never needed, because one can always choose a
string of </span><span class="emphasis">*<span class="string">n</span>*</span><span class="string"> backtick characters as delimiters, where the code does
not contain any strings of exactly </span><span class="emphasis">*<span class="string">n</span>*</span><span class="string"> backtick characters.</span>
</span>
<span class="paragraph"><span class="string">Code span backticks have higher precedence than any other inline
constructs except HTML tags and autolinks.  Thus, for example, this is
not parsed as emphasized text, since the second </span><span class="code">`*`</span><span class="string"> is part of a code
span:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo`*`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*foo&lt;code&gt;*&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">And this is not parsed as a link:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[not␣a␣`link](/foo`)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[not␣a␣&lt;code&gt;link](/foo&lt;/code&gt;)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Code spans, HTML tags, and autolinks have the same precedence.
Thus, this is code:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`&lt;a␣href=&quot;`&quot;&gt;`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;&amp;lt;a␣href=&amp;quot;&lt;/code&gt;&amp;quot;&amp;gt;`&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">But this is an HTML tag:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;`&quot;&gt;`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;`&quot;&gt;`&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">And this is code:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`&lt;http://foo.bar.`baz&gt;`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;&amp;lt;http://foo.bar.&lt;/code&gt;baz&amp;gt;`&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">But this is an autolink:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;http://foo.bar.`baz&gt;`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;http://foo.bar.%60baz&quot;&gt;http://foo.bar.`baz&lt;/a&gt;`&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">When a backtick string is not closed by a matching backtick string,
we just have literal backticks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
```foo``
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;```foo``&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`foo
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;`foo&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;emphasis-and-strong-emphasis&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.4 Emphasis and strong emphasis</span></span>
</span>
<span class="paragraph"><span class="string">John Gruber's original </span><span class="link">[<span class="string">Markdown syntax
description</span>](<span class="destination">http://daringfireball.net/projects/markdown/syntax#em</span>)</span><span class="string"> says:</span>
</span>
<span class="quote block">&gt; <span class="content"><span class="paragraph"><span class="string">Markdown treats asterisks (</span><span class="code">`*`</span><span class="string">) and underscores (</span><span class="code">`_`</span><span class="string">) as indicators of
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">emphasis. Text wrapped with one </span><span class="code">`*`</span><span class="string"> or </span><span class="code">`_`</span><span class="string"> will be wrapped with an HTML
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="code">`&lt;em&gt;`</span><span class="string"> tag; double </span><span class="code">`*`</span><span class="string">'s or </span><span class="code">`_`</span><span class="string">'s will be wrapped with an HTML </span><span class="code">`&lt;strong&gt;`</span><span class="string">
</span></span></span>&gt; <span class="content"><span class="paragraph"><span class="string">tag.</span>
</span></span></span>
<span class="paragraph"><span class="string">This is enough for most users, but these rules leave much undecided,
especially when it comes to nested emphasis.  The original
</span><span class="code">`Markdown.pl`</span><span class="string"> test suite makes it clear that triple </span><span class="code">`***`</span><span class="string"> and
</span><span class="code">`___`</span><span class="string"> delimiters can be used for strong emphasis, and most
implementations have also allowed the following patterns:</span>
</span>
<span class="fenced code block">``` markdown
***strong emph***
***strong** in emph*
***emph* in strong**
**in strong *emph***
*in emph **strong***
```
</span>
<span class="paragraph"><span class="string">The following patterns are less widely supported, but the intent
is clear and they are useful (especially in contexts like bibliography
entries):</span>
</span>
<span class="fenced code block">``` markdown
*emph *with emph* in it*
**strong **with strong** in it**
```
</span>
<span class="paragraph"><span class="string">Many implementations have also restricted intraword emphasis to
the </span><span class="code">`*`</span><span class="string"> forms, to avoid unwanted emphasis in words containing
internal underscores.  (It is best practice to put these in code
spans, but users often do not.)</span>
</span>
<span class="fenced code block">``` markdown
internal emphasis: foo*bar*baz
no emphasis: foo_bar_baz
```
</span>
<span class="paragraph"><span class="string">The rules given below capture all of these patterns, while allowing
for efficient parsing strategies that do not backtrack.</span>
</span>
<span class="paragraph"><span class="string">First, some definitions.  A </span><span class="link">[<span class="string">delimiter run</span>](<span class="destination">@delimiter-run</span>)</span><span class="string"> is either
a sequence of one or more </span><span class="code">`*`</span><span class="string"> characters that is not preceded or
followed by a </span><span class="code">`*`</span><span class="string"> character, or a sequence of one or more </span><span class="code">`_`</span><span class="string">
characters that is not preceded or followed by a </span><span class="code">`_`</span><span class="string"> character.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">left-flanking delimiter run</span>](<span class="destination">@left-flanking-delimiter-run</span>)</span><span class="string"> is
a </span><span class="link">[<span class="string">delimiter run</span>]</span><span class="string"> that is (a) not followed by </span><span class="link">[<span class="string">unicode whitespace</span>]</span><span class="string">,
and (b) either not followed by a </span><span class="link">[<span class="string">punctuation character</span>]</span><span class="string">, or
preceded by </span><span class="link">[<span class="string">unicode whitespace</span>]</span><span class="string"> or a </span><span class="link">[<span class="string">punctuation character</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">right-flanking delimiter run</span>](<span class="destination">@right-flanking-delimiter-run</span>)</span><span class="string"> is
a </span><span class="link">[<span class="string">delimiter run</span>]</span><span class="string"> that is (a) not preceded by </span><span class="link">[<span class="string">unicode whitespace</span>]</span><span class="string">,
and (b) either not preceded by a </span><span class="link">[<span class="string">punctuation character</span>]</span><span class="string">, or
followed by </span><span class="link">[<span class="string">unicode whitespace</span>]</span><span class="string"> or a </span><span class="link">[<span class="string">punctuation character</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">Here are some examples of delimiter runs.</span>
</span>
<span class="list"><span class="list item">  - <span class="content"><span class="paragraph"><span class="string">left-flanking but not right-flanking:</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">```
</span></span>    <span class="content"><span class="fenced code block">***abc
</span></span>    <span class="content"><span class="fenced code block">  _abc
</span></span>    <span class="content"><span class="fenced code block">**&quot;abc&quot;
</span></span>    <span class="content"><span class="fenced code block"> _&quot;abc&quot;
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">  - <span class="content"><span class="paragraph"><span class="string">right-flanking but not left-flanking:</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">```
</span></span>    <span class="content"><span class="fenced code block">abc***
</span></span>    <span class="content"><span class="fenced code block">  abc_
</span></span>    <span class="content"><span class="fenced code block">&quot;abc&quot;**
</span></span>    <span class="content"><span class="fenced code block"> _&quot;abc&quot;
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">  - <span class="content"><span class="paragraph"><span class="string">Both right and right-flanking:</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">```
</span></span>    <span class="content"><span class="fenced code block">abc***def
</span></span>    <span class="content"><span class="fenced code block">&quot;abc&quot;_&quot;def&quot;
</span></span>    <span class="content"><span class="fenced code block">```
</span></span>
</span><span class="list item">  - <span class="content"><span class="paragraph"><span class="string">Neither right nor right-flanking:</span>
</span></span><span class="content">
</span>    <span class="content"><span class="fenced code block">```
</span></span>    <span class="content"><span class="fenced code block">abc *** def
</span></span>    <span class="content"><span class="fenced code block">a _ b
</span></span>    <span class="content"><span class="fenced code block">```
</span></span></span></span>
<span class="paragraph"><span class="string">(The idea of distinguishing left-flanking and right-flanking
delimiter runs based on the character before and the character
after comes from Roopesh Chander's
</span><span class="link">[<span class="string">vfmd</span>](<span class="destination">http://www.vfmd.org/vfmd-spec/specification/#procedure-for-identifying-emphasis-tags</span>)</span><span class="string">.
vfmd uses the terminology &quot;emphasis indicator string&quot; instead of &quot;delimiter
run,&quot; and its rules for distinguishing left- and right-flanking runs
are a bit more complex than the ones given here.)</span>
</span>
<span class="paragraph"><span class="string">The following rules define emphasis and strong emphasis:</span>
</span>
<span class="list"><span class="list item">1.  <span class="content"><span class="paragraph"><span class="string">A single </span><span class="code">`*`</span><span class="string"> character </span><span class="link">[<span class="string">can open emphasis</span>](<span class="destination">@can-open-emphasis</span>)</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">iff it is part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">.</span>
</span></span>
</span><span class="list item">2.  <span class="content"><span class="paragraph"><span class="string">A single </span><span class="code">`_`</span><span class="string"> character </span><span class="link">[<span class="string">can open emphasis</span>]</span><span class="string"> iff
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">it is part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">and not part of a </span><span class="link">[<span class="string">right-flanking delimiter run</span>]</span><span class="string">.</span>
</span></span>
</span><span class="list item">3.  <span class="content"><span class="paragraph"><span class="string">A single </span><span class="code">`*`</span><span class="string"> character </span><span class="link">[<span class="string">can close emphasis</span>](<span class="destination">@can-close-emphasis</span>)</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">iff it is part of a </span><span class="link">[<span class="string">right-flanking delimiter run</span>]</span><span class="string">.</span>
</span></span>
</span><span class="list item">4.  <span class="content"><span class="paragraph"><span class="string">A single </span><span class="code">`_`</span><span class="string"> character </span><span class="link">[<span class="string">can close emphasis</span>]</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">iff it is part of a </span><span class="link">[<span class="string">right-flanking delimiter run</span>]</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">and not part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">.</span>
</span></span>
</span><span class="list item">5.  <span class="content"><span class="paragraph"><span class="string">A double </span><span class="code">`**`</span><span class="string"> </span><span class="link">[<span class="string">can open strong emphasis</span>](<span class="destination">@can-open-strong-emphasis</span>)</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">iff it is part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">.</span>
</span></span>
</span><span class="list item">6.  <span class="content"><span class="paragraph"><span class="string">A double </span><span class="code">`__`</span><span class="string"> </span><span class="link">[<span class="string">can open strong emphasis</span>]</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">iff it is part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">and not part of a </span><span class="link">[<span class="string">right-flanking delimiter run</span>]</span><span class="string">.</span>
</span></span>
</span><span class="list item">7.  <span class="content"><span class="paragraph"><span class="string">A double </span><span class="code">`**`</span><span class="string"> </span><span class="link">[<span class="string">can close strong emphasis</span>](<span class="destination">@can-close-strong-emphasis</span>)</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">iff it is part of a </span><span class="link">[<span class="string">right-flanking delimiter run</span>]</span><span class="string">.</span>
</span></span>
</span><span class="list item">8.  <span class="content"><span class="paragraph"><span class="string">A double </span><span class="code">`__`</span><span class="string"> </span><span class="link">[<span class="string">can close strong emphasis</span>]</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">iff it is part of a </span><span class="link">[<span class="string">right-flanking delimiter run</span>]</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">and not part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">.</span>
</span></span>
</span><span class="list item">9.  <span class="content"><span class="paragraph"><span class="string">Emphasis begins with a delimiter that </span><span class="link">[<span class="string">can open emphasis</span>]</span><span class="string"> and ends
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">with a delimiter that </span><span class="link">[<span class="string">can close emphasis</span>]</span><span class="string">, and that uses the same
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">character (</span><span class="code">`_`</span><span class="string"> or </span><span class="code">`*`</span><span class="string">) as the opening delimiter.  There must
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">be a nonempty sequence of inlines between the open delimiter
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">and the closing delimiter; these form the contents of the emphasis
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">inline.</span>
</span></span>
</span><span class="list item">10. <span class="content"><span class="paragraph"><span class="string">Strong emphasis begins with a delimiter that
</span></span></span>    <span class="content"><span class="paragraph"><span class="link">[<span class="string">can open strong emphasis</span>]</span><span class="string"> and ends with a delimiter that
</span></span></span>    <span class="content"><span class="paragraph"><span class="link">[<span class="string">can close strong emphasis</span>]</span><span class="string">, and that uses the same character
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">(</span><span class="code">`_`</span><span class="string"> or </span><span class="code">`*`</span><span class="string">) as the opening delimiter.
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">There must be a nonempty sequence of inlines between the open
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">delimiter and the closing delimiter; these form the contents of
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">the strong emphasis inline.</span>
</span></span>
</span><span class="list item">11. <span class="content"><span class="paragraph"><span class="string">A literal </span><span class="code">`*`</span><span class="string"> character cannot occur at the beginning or end of
</span></span></span>    <span class="content"><span class="paragraph"><span class="code">`*`</span><span class="string">-delimited emphasis or </span><span class="code">`**`</span><span class="string">-delimited strong emphasis, unless it
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">is backslash-escaped.</span>
</span></span>
</span><span class="list item">12. <span class="content"><span class="paragraph"><span class="string">A literal </span><span class="code">`_`</span><span class="string"> character cannot occur at the beginning or end of
</span></span></span>    <span class="content"><span class="paragraph"><span class="code">`_`</span><span class="string">-delimited emphasis or </span><span class="code">`__`</span><span class="string">-delimited strong emphasis, unless it
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">is backslash-escaped.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">Where rules 1--12 above are compatible with multiple parsings,
the following principles resolve ambiguity:</span>
</span>
<span class="list"><span class="list item">13. <span class="content"><span class="paragraph"><span class="string">The number of nestings should be minimized. Thus, for example,
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">an interpretation </span><span class="code">`&lt;strong&gt;...&lt;/strong&gt;`</span><span class="string"> is always preferred to
</span></span></span>    <span class="content"><span class="paragraph"><span class="code">`&lt;em&gt;&lt;em&gt;...&lt;/em&gt;&lt;/em&gt;`</span><span class="string">.</span>
</span></span>
</span><span class="list item">14. <span class="content"><span class="paragraph"><span class="string">An interpretation </span><span class="code">`&lt;strong&gt;&lt;em&gt;...&lt;/em&gt;&lt;/strong&gt;`</span><span class="string"> is always
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">preferred to </span><span class="code">`&lt;em&gt;&lt;strong&gt;..&lt;/strong&gt;&lt;/em&gt;`</span><span class="string">.</span>
</span></span>
</span><span class="list item">15. <span class="content"><span class="paragraph"><span class="string">When two potential emphasis or strong emphasis spans overlap,
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">so that the second begins before the first ends and ends after
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">the first ends, the first takes precedence. Thus, for example,
</span></span></span>    <span class="content"><span class="paragraph"><span class="code">`*foo _bar* baz_`</span><span class="string"> is parsed as </span><span class="code">`&lt;em&gt;foo _bar&lt;/em&gt; baz_`</span><span class="string"> rather
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">than </span><span class="code">`*foo &lt;em&gt;bar* baz&lt;/em&gt;`</span><span class="string">.  For the same reason,
</span></span></span>    <span class="content"><span class="paragraph"><span class="code">`**foo*bar**`</span><span class="string"> is parsed as </span><span class="code">`&lt;em&gt;&lt;em&gt;foo&lt;/em&gt;bar&lt;/em&gt;*`</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">rather than </span><span class="code">`&lt;strong&gt;foo*bar&lt;/strong&gt;`</span><span class="string">.</span>
</span></span>
</span><span class="list item">16. <span class="content"><span class="paragraph"><span class="string">When there are two potential emphasis or strong emphasis spans
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">with the same closing delimiter, the shorter one (the one that
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">opens later) takes precedence. Thus, for example,
</span></span></span>    <span class="content"><span class="paragraph"><span class="code">`**foo **bar baz**`</span><span class="string"> is parsed as </span><span class="code">`**foo &lt;strong&gt;bar baz&lt;/strong&gt;`</span><span class="string">
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">rather than </span><span class="code">`&lt;strong&gt;foo **bar baz&lt;/strong&gt;`</span><span class="string">.</span>
</span></span>
</span><span class="list item">17. <span class="content"><span class="paragraph"><span class="string">Inline code spans, links, images, and HTML tags group more tightly
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">than emphasis.  So, when there is a choice between an interpretation
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">that contains one of these elements and one that does not, the
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">former always wins.  Thus, for example, </span><span class="code">`*[foo*](bar)`</span><span class="string"> is
</span></span></span>    <span class="content"><span class="paragraph"><span class="string">parsed as </span><span class="code">`*&lt;a href=&quot;bar&quot;&gt;foo*&lt;/a&gt;`</span><span class="string"> rather than as
</span></span></span>    <span class="content"><span class="paragraph"><span class="code">`&lt;em&gt;[foo&lt;/em&gt;](bar)`</span><span class="string">.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">These rules can be illustrated through a series of examples.</span>
</span>
<span class="paragraph"><span class="string">Rule 1:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣bar*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣bar&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the opening </span><span class="code">`*`</span><span class="string"> is followed by
whitespace, and hence not part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
a␣*␣foo␣bar*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;a␣*␣foo␣bar*&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the opening </span><span class="code">`*`</span><span class="string"> is preceded
by an alphanumeric and followed by punctuation, and hence
not part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
a*&quot;foo&quot;*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;a*&amp;quot;foo&amp;quot;*&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Unicode nonbreaking spaces count as whitespace, too:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
* a *
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;* a *&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Intraword emphasis with </span><span class="code">`*`</span><span class="string"> is permitted:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo*bar*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;em&gt;bar&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
5*6*78
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;5&lt;em&gt;6&lt;/em&gt;78&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 2:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo␣bar_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣bar&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the opening </span><span class="code">`_`</span><span class="string"> is followed by
whitespace:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_␣foo␣bar_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_␣foo␣bar_&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the opening </span><span class="code">`_`</span><span class="string"> is preceded
by an alphanumeric and followed by punctuation:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
a_&quot;foo&quot;_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;a_&amp;quot;foo&amp;quot;_&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Emphasis with </span><span class="code">`_`</span><span class="string"> is not allowed inside words:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo_bar_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo_bar_&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
5_6_78
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;5_6_78&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
пристаням_стремятся_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;пристаням_стремятся_&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here </span><span class="code">`_`</span><span class="string"> does not generate emphasis, because the first delimiter run
is right-flanking and the second left-flanking:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
aa_&quot;bb&quot;_cc
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;aa_&amp;quot;bb&amp;quot;_cc&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here there is no emphasis, because the delimiter runs are
both left- and right-flanking:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&quot;aa&quot;_&quot;bb&quot;_&quot;cc&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;quot;aa&amp;quot;_&amp;quot;bb&amp;quot;_&amp;quot;cc&amp;quot;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 3:</span>
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the closing delimiter does
not match the opening delimiter:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_foo*&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the closing </span><span class="code">`*`</span><span class="string"> is preceded by
whitespace:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣bar␣*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*foo␣bar␣*&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the second </span><span class="code">`*`</span><span class="string"> is
preceded by punctuation and followed by an alphanumeric
(hence it is not part of a </span><span class="link">[<span class="string">right-flanking delimiter run</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*(*foo)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*(*foo)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The point of this restriction is more easily appreciated
with this example:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*(*foo*)*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;(&lt;em&gt;foo&lt;/em&gt;)&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Intraword emphasis with </span><span class="code">`*`</span><span class="string"> is allowed:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo*bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;/em&gt;bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">Rule 4:</span>
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the closing </span><span class="code">`_`</span><span class="string"> is preceded by
whitespace:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo␣bar␣_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_foo␣bar␣_&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not emphasis, because the second </span><span class="code">`_`</span><span class="string"> is
preceded by punctuation and followed by an alphanumeric:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_(_foo)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_(_foo)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is emphasis within emphasis:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_(_foo_)_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;(&lt;em&gt;foo&lt;/em&gt;)&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Intraword emphasis is disallowed for </span><span class="code">`_`</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo_bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_foo_bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_пристаням_стремятся
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_пристаням_стремятся&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo_bar_baz_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo_bar_baz&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 5:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣bar**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣bar&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not strong emphasis, because the opening delimiter is
followed by whitespace:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**␣foo␣bar**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;**␣foo␣bar**&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not strong emphasis, because the opening </span><span class="code">`**`</span><span class="string"> is preceded
by an alphanumeric and followed by punctuation, and hence
not part of a </span><span class="link">[<span class="string">left-flanking delimiter run</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
a**&quot;foo&quot;**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;a**&amp;quot;foo&amp;quot;**&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Intraword strong emphasis with </span><span class="code">`**`</span><span class="string"> is permitted:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo**bar**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;strong&gt;bar&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 6:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo␣bar__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣bar&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not strong emphasis, because the opening delimiter is
followed by whitespace:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__␣foo␣bar__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;__␣foo␣bar__&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not strong emphasis, because the opening </span><span class="code">`__`</span><span class="string"> is preceded
by an alphanumeric and followed by punctuation:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
a__&quot;foo&quot;__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;a__&amp;quot;foo&amp;quot;__&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Intraword strong emphasis is forbidden with </span><span class="code">`__`</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo__bar__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo__bar__&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
5__6__78
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;5__6__78&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
пристаням__стремятся__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;пристаням__стремятся__&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo,␣__bar__,␣baz__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo,␣&lt;strong&gt;bar&lt;/strong&gt;,␣baz&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 7:</span>
</span>
<span class="paragraph"><span class="string">This is not strong emphasis, because the closing delimiter is preceded
by whitespace:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣bar␣**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;**foo␣bar␣**&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">(Nor can it be interpreted as an emphasized </span><span class="code">`*foo bar *`</span><span class="string">, because of
Rule 11.)</span>
</span>
<span class="paragraph"><span class="string">This is not strong emphasis, because the second </span><span class="code">`**`</span><span class="string"> is
preceded by punctuation and followed by an alphanumeric:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**(**foo)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;**(**foo)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The point of this restriction is more easily appreciated
with these examples:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*(**foo**)*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;(&lt;strong&gt;foo&lt;/strong&gt;)&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**Gomphocarpus␣(*Gomphocarpus␣physocarpus*,␣syn.
*Asclepias␣physocarpa*)**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;Gomphocarpus␣(&lt;em&gt;Gomphocarpus␣physocarpus&lt;/em&gt;,␣syn.
&lt;em&gt;Asclepias␣physocarpa&lt;/em&gt;)&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣&quot;*bar*&quot;␣foo**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&amp;quot;&lt;em&gt;bar&lt;/em&gt;&amp;quot;␣foo&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Intraword emphasis:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo**bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo&lt;/strong&gt;bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 8:</span>
</span>
<span class="paragraph"><span class="string">This is not strong emphasis, because the closing delimiter is
preceded by whitespace:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo␣bar␣__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;__foo␣bar␣__&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">This is not strong emphasis, because the second </span><span class="code">`__`</span><span class="string"> is
preceded by punctuation and followed by an alphanumeric:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__(__foo)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;__(__foo)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The point of this restriction is more easily appreciated
with this example:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_(__foo__)_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;(&lt;strong&gt;foo&lt;/strong&gt;)&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Intraword strong emphasis is forbidden with </span><span class="code">`__`</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo__bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;__foo__bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__пристаням__стремятся
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;__пристаням__стремятся&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo__bar__baz__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo__bar__baz&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 9:</span>
</span>
<span class="paragraph"><span class="string">Any nonempty sequence of inline elements can be the contents of an
emphasized span.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣[bar](/url)*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣&lt;a␣href=&quot;/url&quot;&gt;bar&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo
bar*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo
bar&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">In particular, emphasis and strong emphasis can be nested
inside emphasis:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo␣__bar__␣baz_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣&lt;strong&gt;bar&lt;/strong&gt;␣baz&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo␣_bar_␣baz_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣&lt;em&gt;bar&lt;/em&gt;␣baz&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo_␣bar_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;&lt;em&gt;foo&lt;/em&gt;␣bar&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣*bar**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣&lt;em&gt;bar&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣**bar**␣baz*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣&lt;strong&gt;bar&lt;/strong&gt;␣baz&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">But note:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo**bar**baz*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;/em&gt;&lt;em&gt;bar&lt;/em&gt;&lt;em&gt;baz&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The difference is that in the preceding case, the internal delimiters
</span><span class="link">[<span class="string">can close emphasis</span>]</span><span class="string">, while in the cases with spaces, they cannot.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
***foo**␣bar*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;&lt;strong&gt;foo&lt;/strong&gt;␣bar&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣**bar***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣&lt;strong&gt;bar&lt;/strong&gt;&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note, however, that in the following case we get no strong
emphasis, because the opening delimiter is closed by the first
</span><span class="code">`*`</span><span class="string"> before </span><span class="code">`bar`</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo**bar***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;/em&gt;&lt;em&gt;bar&lt;/em&gt;**&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">Indefinite levels of nesting are possible:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣**bar␣*baz*␣bim**␣bop*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣&lt;strong&gt;bar␣&lt;em&gt;baz&lt;/em&gt;␣bim&lt;/strong&gt;␣bop&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣[*bar*](/url)*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣&lt;a␣href=&quot;/url&quot;&gt;&lt;em&gt;bar&lt;/em&gt;&lt;/a&gt;&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">There can be no empty emphasis or strong emphasis:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**␣is␣not␣an␣empty␣emphasis
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;**␣is␣not␣an␣empty␣emphasis&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
****␣is␣not␣an␣empty␣strong␣emphasis
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;****␣is␣not␣an␣empty␣strong␣emphasis&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">Rule 10:</span>
</span>
<span class="paragraph"><span class="string">Any nonempty sequence of inline elements can be the contents of an
strongly emphasized span.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣[bar](/url)**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&lt;a␣href=&quot;/url&quot;&gt;bar&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo
bar**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo
bar&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">In particular, emphasis and strong emphasis can be nested
inside strong emphasis:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo␣_bar_␣baz__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&lt;em&gt;bar&lt;/em&gt;␣baz&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo␣__bar__␣baz__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&lt;strong&gt;bar&lt;/strong&gt;␣baz&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
____foo__␣bar__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;&lt;strong&gt;foo&lt;/strong&gt;␣bar&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣**bar****
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&lt;strong&gt;bar&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣*bar*␣baz**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&lt;em&gt;bar&lt;/em&gt;␣baz&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">But note:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo*bar*baz**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;&lt;em&gt;foo&lt;/em&gt;bar&lt;/em&gt;baz**&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The difference is that in the preceding case, the internal delimiters
</span><span class="link">[<span class="string">can close emphasis</span>]</span><span class="string">, while in the cases with spaces, they cannot.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
***foo*␣bar**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;&lt;em&gt;foo&lt;/em&gt;␣bar&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣*bar***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&lt;em&gt;bar&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Indefinite levels of nesting are possible:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣*bar␣**baz**
bim*␣bop**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&lt;em&gt;bar␣&lt;strong&gt;baz&lt;/strong&gt;
bim&lt;/em&gt;␣bop&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣[*bar*](/url)**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo␣&lt;a␣href=&quot;/url&quot;&gt;&lt;em&gt;bar&lt;/em&gt;&lt;/a&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">There can be no empty emphasis or strong emphasis:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__␣is␣not␣an␣empty␣emphasis
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;__␣is␣not␣an␣empty␣emphasis&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
____␣is␣not␣an␣empty␣strong␣emphasis
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;____␣is␣not␣an␣empty␣strong␣emphasis&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">Rule 11:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣***&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣*\**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;em&gt;*&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣*_*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;em&gt;_&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣*****
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣*****&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣**\***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;strong&gt;*&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣**_**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;strong&gt;_&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that when delimiters do not match evenly, Rule 11 determines
that the excess literal </span><span class="code">`*`</span><span class="string"> characters will appear outside of the
emphasis, rather than inside it:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*&lt;em&gt;foo&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;/em&gt;*&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
***foo**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*&lt;strong&gt;foo&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
****foo*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;***&lt;em&gt;foo&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo&lt;/strong&gt;*&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo****
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;/em&gt;***&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">Rule 12:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣___
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣___&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣_\__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;em&gt;_&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣_*_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;em&gt;*&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣_____
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣_____&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣__\___
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;strong&gt;_&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣__*__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;strong&gt;*&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_&lt;em&gt;foo&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that when delimiters do not match evenly, Rule 12 determines
that the excess literal </span><span class="code">`_`</span><span class="string"> characters will appear outside of the
emphasis, rather than inside it:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;/em&gt;_&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
___foo__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_&lt;strong&gt;foo&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
____foo_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;___&lt;em&gt;foo&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo___
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo&lt;/strong&gt;_&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo____
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;/em&gt;___&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 13 implies that if you want emphasis nested directly inside
emphasis, you must use different delimiters:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*_foo_*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;&lt;em&gt;foo&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__foo__
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;foo&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_*foo*_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;&lt;em&gt;foo&lt;/em&gt;&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, strong emphasis within strong emphasis is possible without
switching delimiters:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
****foo****
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;&lt;strong&gt;foo&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
____foo____
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;&lt;strong&gt;foo&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">Rule 13 can be applied to arbitrarily long sequences of
delimiters:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
******foo******
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;&lt;strong&gt;&lt;strong&gt;foo&lt;/strong&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 14:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
***foo***
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;&lt;em&gt;foo&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_____foo_____
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;strong&gt;&lt;strong&gt;&lt;em&gt;foo&lt;/em&gt;&lt;/strong&gt;&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 15:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣_bar*␣baz_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣_bar&lt;/em&gt;␣baz_&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo*bar**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;&lt;em&gt;foo&lt;/em&gt;bar&lt;/em&gt;*&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">Rule 16:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**foo␣**bar␣baz**
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;**foo␣&lt;strong&gt;bar␣baz&lt;/strong&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣*bar␣baz*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*foo␣&lt;em&gt;bar␣baz&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Rule 17:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*[bar*](/url)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*&lt;a␣href=&quot;/url&quot;&gt;bar*&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_foo␣[bar_](/url)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;_foo␣&lt;a␣href=&quot;/url&quot;&gt;bar_&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*&lt;img␣src=&quot;foo&quot;␣title=&quot;*&quot;/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*&lt;img␣src=&quot;foo&quot;␣title=&quot;*&quot;/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**&lt;a␣href=&quot;**&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;**&lt;a␣href=&quot;**&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__&lt;a␣href=&quot;__&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;__&lt;a␣href=&quot;__&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*a␣`*`*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;a␣&lt;code&gt;*&lt;/code&gt;&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
_a␣`_`_
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;a␣&lt;code&gt;_&lt;/code&gt;&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
**a&lt;http://foo.bar?q=**&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;**a&lt;a␣href=&quot;http://foo.bar?q=**&quot;&gt;http://foo.bar?q=**&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
__a&lt;http://foo.bar?q=__&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;__a&lt;a␣href=&quot;http://foo.bar?q=__&quot;&gt;http://foo.bar?q=__&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;links&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.5 Links</span></span>
</span>
<span class="paragraph"><span class="string">A link contains </span><span class="link">[<span class="string">link text</span>]</span><span class="string"> (the visible text), a </span><span class="link">[<span class="string">link destination</span>]</span><span class="string">
(the URI that is the link destination), and optionally a </span><span class="link">[<span class="string">link title</span>]</span><span class="string">.
There are two basic kinds of links in Markdown.  In </span><span class="link">[<span class="string">inline link</span>]</span><span class="string">s the
destination and title are given immediately after the link text.  In
</span><span class="link">[<span class="string">reference link</span>]</span><span class="string">s the destination and title are defined elsewhere in
the document.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">link text</span>](<span class="destination">@link-text</span>)</span><span class="string"> consists of a sequence of zero or more
inline elements enclosed by square brackets (</span><span class="code">`[`</span><span class="string"> and </span><span class="code">`]`</span><span class="string">).  The
following rules apply:</span>
</span>
<span class="list"><span class="list item">- <span class="content"><span class="paragraph"><span class="string">Links may not contain other links, at any level of nesting.</span>
</span></span>
</span><span class="list item">- <span class="content"><span class="paragraph"><span class="string">Brackets are allowed in the </span><span class="link">[<span class="string">link text</span>]</span><span class="string"> only if (a) they
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">are backslash-escaped or (b) they appear as a matched pair of brackets,
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">with an open bracket </span><span class="code">`[`</span><span class="string">, a sequence of zero or more inlines, and
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">a close bracket </span><span class="code">`]`</span><span class="string">.</span>
</span></span>
</span><span class="list item">- <span class="content"><span class="paragraph"><span class="string">Backtick </span><span class="link">[<span class="string">code span</span>]</span><span class="string">s, </span><span class="link">[<span class="string">autolink</span>]</span><span class="string">s, and raw </span><span class="link">[<span class="string">HTML tag</span>]</span><span class="string">s bind more tightly
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">than the brackets in link text.  Thus, for example,
</span></span></span>  <span class="content"><span class="paragraph"><span class="code">`` [foo`]` ``</span><span class="string"> could not be a link text, since the second </span><span class="code">`]`</span><span class="string">
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">is part of a code span.</span>
</span></span>
</span><span class="list item">- <span class="content"><span class="paragraph"><span class="string">The brackets in link text bind more tightly than markers for
</span></span></span>  <span class="content"><span class="paragraph"><span class="link">[<span class="string">emphasis and strong emphasis</span>]</span><span class="string">. Thus, for example, </span><span class="code">`*[foo*](url)`</span><span class="string"> is a link.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">link destination</span>](<span class="destination">@link-destination</span>)</span><span class="string"> consists of either</span>
</span>
<span class="list"><span class="list item">- <span class="content"><span class="paragraph"><span class="string">a sequence of zero or more characters between an opening </span><span class="code">`&lt;`</span><span class="string"> and a
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">closing </span><span class="code">`&gt;`</span><span class="string"> that contains no line breaks or unescaped </span><span class="code">`&lt;`</span><span class="string"> or </span><span class="code">`&gt;`</span><span class="string">
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">characters, or</span>
</span></span>
</span><span class="list item">- <span class="content"><span class="paragraph"><span class="string">a nonempty sequence of characters that does not include
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">ASCII space or control characters, and includes parentheses
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">only if (a) they are backslash-escaped or (b) they are part of
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">a balanced pair of unescaped parentheses that is not itself
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">inside a balanced pair of unescaped paretheses.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">link title</span>](<span class="destination">@link-title</span>)</span><span class="string">  consists of either</span>
</span>
<span class="list"><span class="list item">- <span class="content"><span class="paragraph"><span class="string">a sequence of zero or more characters between straight double-quote
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">characters (</span><span class="code">`&quot;`</span><span class="string">), including a </span><span class="code">`&quot;`</span><span class="string"> character only if it is
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">backslash-escaped, or</span>
</span></span>
</span><span class="list item">- <span class="content"><span class="paragraph"><span class="string">a sequence of zero or more characters between straight single-quote
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">characters (</span><span class="code">`'`</span><span class="string">), including a </span><span class="code">`'`</span><span class="string"> character only if it is
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">backslash-escaped, or</span>
</span></span>
</span><span class="list item">- <span class="content"><span class="paragraph"><span class="string">a sequence of zero or more characters between matching parentheses
</span></span></span>  <span class="content"><span class="paragraph"><span class="string">(</span><span class="code">`(...)`</span><span class="string">), including a </span><span class="code">`)`</span><span class="string"> character only if it is backslash-escaped.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">inline link</span>](<span class="destination">@inline-link</span>)</span><span class="string"> consists of a </span><span class="link">[<span class="string">link text</span>]</span><span class="string"> followed immediately
by a left parenthesis </span><span class="code">`(`</span><span class="string">, optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, an optional
</span><span class="link">[<span class="string">link destination</span>]</span><span class="string">, an optional </span><span class="link">[<span class="string">link title</span>]</span><span class="string"> separated from the link
destination by </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, and a right
parenthesis </span><span class="code">`)`</span><span class="string">. The link's text consists of the inlines contained
in the </span><span class="link">[<span class="string">link text</span>]</span><span class="string"> (excluding the enclosing square brackets).
The link's URI consists of the link destination, excluding enclosing
</span><span class="code">`&lt;...&gt;`</span><span class="string"> if present, with backslash-escapes in effect as described
above.  The link's title consists of the link title, excluding its
enclosing delimiters, with backslash-escapes in effect as described
above.</span>
</span>
<span class="paragraph"><span class="string">Here is a simple inline link:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](/uri␣&quot;title&quot;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;␣title=&quot;title&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The title may be omitted:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Both the title and the destination may be omitted:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link]()
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](&lt;&gt;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If the destination contains spaces, it must be enclosed in pointy
braces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](/my␣uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[link](/my␣uri)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](&lt;/my␣uri&gt;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/my%20uri&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The destination cannot contain line breaks, even with pointy braces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](foo
bar)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[link](foo
bar)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](&lt;foo
bar&gt;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[link](&lt;foo
bar&gt;)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">One level of balanced parentheses is allowed without escaping:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link]((foo)and(bar))
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;(foo)and(bar)&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, if you have parentheses within parentheses, you need to escape
or use the </span><span class="code">`&lt;...&gt;`</span><span class="string"> form:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](foo(and(bar)))
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[link](foo(and(bar)))&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](foo(and\(bar\)))
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;foo(and(bar))&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](&lt;foo(and(bar))&gt;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;foo(and(bar))&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Parentheses and other symbols can also be escaped, as usual
in Markdown:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](foo\)\:)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;foo):&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">URL-escaping should be left alone inside the destination, as all
URL-escaped characters are also valid URL characters. HTML entities in
the destination will be parsed into their UTF-8 codepoints, as usual, and
optionally URL-escaped when written as HTML.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](foo%20b&amp;auml;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;foo%20b%C3%A4&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that, because titles can often be parsed as destinations,
if you try to omit the destination and keep the title, you'll
get unexpected results:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](&quot;title&quot;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;%22title%22&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Titles may be in single quotes, double quotes, or parentheses:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](/url␣&quot;title&quot;)
[link](/url␣'title')
[link](/url␣(title))
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;link&lt;/a&gt;
&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;link&lt;/a&gt;
&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Backslash escapes and entities may be used in titles:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](/url␣&quot;title␣\&quot;&amp;quot;&quot;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title␣&amp;quot;&amp;quot;&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Nested balanced quotes are not allowed without escaping:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](/url␣&quot;title␣&quot;and&quot;␣title&quot;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[link](/url␣&amp;quot;title␣&amp;quot;and&amp;quot;␣title&amp;quot;)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">But it is easy to work around this by using a different quote type:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](/url␣'title␣&quot;and&quot;␣title')
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title␣&amp;quot;and&amp;quot;␣title&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">(Note:  </span><span class="code">`Markdown.pl`</span><span class="string"> did allow double quotes inside a double-quoted
title, and its test suite included a test demonstrating this.
But it is hard to see a good rationale for the extra complexity this
brings, since there are already many ways---backslash escaping,
entities, or using a different quote type for the enclosing title---to
write titles containing double quotes.  </span><span class="code">`Markdown.pl`</span><span class="string">'s handling of
titles has a number of other strange features.  For example, it allows
single-quoted titles in inline links, but not reference links.  And, in
reference links but not inline links, it allows a title to begin with
</span><span class="code">`&quot;`</span><span class="string"> and end with </span><span class="code">`)`</span><span class="string">.  </span><span class="code">`Markdown.pl`</span><span class="string"> 1.0.1 even allows titles with no closing
quotation mark, though 1.0.2b8 does not.  It seems preferable to adopt
a simple, rational rule that works the same way in inline links and
link reference definitions.)</span>
</span>
<span class="paragraph"><span class="link">[<span class="string">Whitespace</span>]</span><span class="string"> is allowed around the destination and title:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link](␣␣␣/uri
␣␣&quot;title&quot;␣␣)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;␣title=&quot;title&quot;&gt;link&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">But it is not allowed between the link text and the
following parenthesis:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link]␣(/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[link]␣(/uri)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The link text may contain balanced brackets, but not unbalanced ones,
unless they are escaped:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link␣[foo␣[bar]]](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;link␣[foo␣[bar]]&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link]␣bar](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[link]␣bar](/uri)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link␣[bar](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[link␣&lt;a␣href=&quot;/uri&quot;&gt;bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link␣\[bar](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;link␣[bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The link text may contain inline content:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link␣*foo␣**bar**␣`#`*](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;link␣&lt;em&gt;foo␣&lt;strong&gt;bar&lt;/strong&gt;␣&lt;code&gt;#&lt;/code&gt;&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[![moon](moon.jpg)](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;&lt;img␣src=&quot;moon.jpg&quot;␣alt=&quot;moon&quot;␣/&gt;&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, links may not contain other links, at any level of nesting.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo␣[bar](/uri)](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo␣&lt;a␣href=&quot;/uri&quot;&gt;bar&lt;/a&gt;](/uri)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo␣*[bar␣[baz](/uri)](/uri)*](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo␣&lt;em&gt;[bar␣&lt;a␣href=&quot;/uri&quot;&gt;baz&lt;/a&gt;](/uri)&lt;/em&gt;](/uri)&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![[[foo](uri1)](uri2)](uri3)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;uri3&quot;␣alt=&quot;[foo](uri2)&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">These cases illustrate the precedence of link text grouping over
emphasis grouping:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*[foo*](/uri)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*&lt;a␣href=&quot;/uri&quot;&gt;foo*&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo␣*bar](baz*)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;baz*&quot;&gt;foo␣*bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that brackets that </span><span class="emphasis">*<span class="string">aren't</span>*</span><span class="string"> part of links do not take
precedence:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣[bar*␣baz]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo␣[bar&lt;/em&gt;␣baz]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">These cases illustrate the precedence of HTML tags, code spans,
and autolinks over link grouping:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo␣&lt;bar␣attr=&quot;](baz)&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo␣&lt;bar␣attr=&quot;](baz)&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo`](/uri)`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo&lt;code&gt;](/uri)&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo&lt;http://example.com?search=](uri)&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo&lt;a␣href=&quot;http://example.com?search=%5D(uri)&quot;&gt;http://example.com?search=](uri)&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">There are three kinds of </span><span class="link">[<span class="string">reference link</span>](<span class="destination">@reference-link</span>)</span><span class="string">s:
</span><span class="link">[<span class="string">full</span>](<span class="destination">#full-reference-link</span>)</span><span class="string">, </span><span class="link">[<span class="string">collapsed</span>](<span class="destination">#collapsed-reference-link</span>)</span><span class="string">,
and </span><span class="link">[<span class="string">shortcut</span>](<span class="destination">#shortcut-reference-link</span>)</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">full reference link</span>](<span class="destination">@full-reference-link</span>)</span><span class="string">
consists of a </span><span class="link">[<span class="string">link text</span>]</span><span class="string">, optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, and a </span><span class="link">[<span class="string">link label</span>]</span><span class="string">
that </span><span class="link">[<span class="string">matches</span>]</span><span class="string"> a </span><span class="link">[<span class="string">link reference definition</span>]</span><span class="string"> elsewhere in the document.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">link label</span>](<span class="destination">@link-label</span>)</span><span class="string">  begins with a left bracket (</span><span class="code">`[`</span><span class="string">) and ends
with the first right bracket (</span><span class="code">`]`</span><span class="string">) that is not backslash-escaped.
Unescaped square bracket characters are not allowed in
</span><span class="link">[<span class="string">link label</span>]</span><span class="string">s.  A link label can have at most 999
characters inside the square brackets.</span>
</span>
<span class="paragraph"><span class="string">One label </span><span class="link">[<span class="string">matches</span>](<span class="destination">@matches</span>)</span><span class="string">
another just in case their normalized forms are equal.  To normalize a
label, perform the </span><span class="emphasis">*<span class="string">unicode case fold</span>*</span><span class="string"> and collapse consecutive internal
</span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> to a single space.  If there are multiple
matching reference link definitions, the one that comes first in the
document is used.  (It is desirable in such cases to emit a warning.)</span>
</span>
<span class="paragraph"><span class="string">The contents of the first link label are parsed as inlines, which are
used as the link's text.  The link's URI and title are provided by the
matching </span><span class="link">[<span class="string">link reference definition</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">Here is a simple example:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][bar]

[bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The rules for the </span><span class="link">[<span class="string">link text</span>]</span><span class="string"> are the same as with
</span><span class="link">[<span class="string">inline link</span>]</span><span class="string">s.  Thus:</span>
</span>
<span class="paragraph"><span class="string">The link text may contain balanced brackets, but not unbalanced ones,
unless they are escaped:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link␣[foo␣[bar]]][ref]

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;link␣[foo␣[bar]]&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link␣\[bar][ref]

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;link␣[bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The link text may contain inline content:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[link␣*foo␣**bar**␣`#`*][ref]

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;link␣&lt;em&gt;foo␣&lt;strong&gt;bar&lt;/strong&gt;␣&lt;code&gt;#&lt;/code&gt;&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[![moon](moon.jpg)][ref]

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;&lt;img␣src=&quot;moon.jpg&quot;␣alt=&quot;moon&quot;␣/&gt;&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">However, links may not contain other links, at any level of nesting.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo␣[bar](/uri)][ref]

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo␣&lt;a␣href=&quot;/uri&quot;&gt;bar&lt;/a&gt;]&lt;a␣href=&quot;/uri&quot;&gt;ref&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo␣*bar␣[baz][ref]*][ref]

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo␣&lt;em&gt;bar␣&lt;a␣href=&quot;/uri&quot;&gt;baz&lt;/a&gt;&lt;/em&gt;]&lt;a␣href=&quot;/uri&quot;&gt;ref&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">(In the examples above, we have two </span><span class="link">[<span class="string">shortcut reference link</span>]</span><span class="string">s
instead of one </span><span class="link">[<span class="string">full reference link</span>]</span><span class="string">.)</span>
</span>
<span class="paragraph"><span class="string">The following cases illustrate the precedence of link text grouping over
emphasis grouping:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*[foo*][ref]

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*&lt;a␣href=&quot;/uri&quot;&gt;foo*&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo␣*bar][ref]

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;foo␣*bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">These cases illustrate the precedence of HTML tags, code spans,
and autolinks over link grouping:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo␣&lt;bar␣attr=&quot;][ref]&quot;&gt;

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo␣&lt;bar␣attr=&quot;][ref]&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo`][ref]`

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo&lt;code&gt;][ref]&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo&lt;http://example.com?search=][ref]&gt;

[ref]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo&lt;a␣href=&quot;http://example.com?search=%5D%5Bref%5D&quot;&gt;http://example.com?search=][ref]&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Matching is case-insensitive:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][BaR]

[bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Unicode case fold is used:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[Толпой][Толпой]␣is␣a␣Russian␣word.

[ТОЛПОЙ]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;&gt;Толпой&lt;/a&gt;␣is␣a␣Russian␣word.&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Consecutive internal </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> is treated as one space for
purposes of determining matching:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[Foo
␣␣bar]:␣/url

[Baz][Foo␣bar]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;&gt;Baz&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">There can be </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> between the </span><span class="link">[<span class="string">link text</span>]</span><span class="string"> and the </span><span class="link">[<span class="string">link label</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]␣[bar]

[bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]
[bar]

[bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">When there are multiple matching </span><span class="link">[<span class="string">link reference definition</span>]</span><span class="string">s,
the first is used:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]:␣/url1

[foo]:␣/url2

[bar][foo]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url1&quot;&gt;bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that matching is performed on normalized strings, not parsed
inline content.  So the following does not match, even though the
labels define equivalent inline content:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[bar][foo\!]

[foo!]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[bar][foo!]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="link">[<span class="string">Link label</span>]</span><span class="string">s cannot contain brackets, unless they are
backslash-escaped:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][ref[]

[ref[]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo][ref[]&lt;/p&gt;
&lt;p&gt;[ref[]:␣/uri&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][ref[bar]]

[ref[bar]]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo][ref[bar]]&lt;/p&gt;
&lt;p&gt;[ref[bar]]:␣/uri&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[[[foo]]]

[[[foo]]]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[[[foo]]]&lt;/p&gt;
&lt;p&gt;[[[foo]]]:␣/url&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][ref\[]

[ref\[]:␣/uri
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/uri&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">collapsed reference link</span>](<span class="destination">@collapsed-reference-link</span>)</span><span class="string">
consists of a </span><span class="link">[<span class="string">link label</span>]</span><span class="string"> that </span><span class="link">[<span class="string">matches</span>]</span><span class="string"> a
</span><span class="link">[<span class="string">link reference definition</span>]</span><span class="string"> elsewhere in the
document, optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, and the string </span><span class="code">`[]`</span><span class="string">.
The contents of the first link label are parsed as inlines,
which are used as the link's text.  The link's URI and title are
provided by the matching reference link definition.  Thus,
</span><span class="code">`[foo][]`</span><span class="string"> is equivalent to </span><span class="code">`[foo][foo]`</span><span class="string">.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[*foo*␣bar][]

[*foo*␣bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;&lt;em&gt;foo&lt;/em&gt;␣bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The link labels are case-insensitive:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[Foo][]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;Foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="paragraph"><span class="string">As with full reference links, </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> is allowed
between the two sets of brackets:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]␣
[]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">shortcut reference link</span>](<span class="destination">@shortcut-reference-link</span>)</span><span class="string">
consists of a </span><span class="link">[<span class="string">link label</span>]</span><span class="string"> that </span><span class="link">[<span class="string">matches</span>]</span><span class="string"> a
</span><span class="link">[<span class="string">link reference definition</span>]</span><span class="string"> elsewhere in the
document and is not followed by </span><span class="code">`[]`</span><span class="string"> or a link label.
The contents of the first link label are parsed as inlines,
which are used as the link's text.  the link's URI and title
are provided by the matching link reference definition.
Thus, </span><span class="code">`[foo]`</span><span class="string"> is equivalent to </span><span class="code">`[foo][]`</span><span class="string">.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[*foo*␣bar]

[*foo*␣bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;&lt;em&gt;foo&lt;/em&gt;␣bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[[*foo*␣bar]]

[*foo*␣bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;&lt;em&gt;foo&lt;/em&gt;␣bar&lt;/a&gt;]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The link labels are case-insensitive:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[Foo]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;Foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A space after the link text should be preserved:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo]␣bar

[foo]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url&quot;&gt;foo&lt;/a&gt;␣bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If you just want bracketed text, you can backslash-escape the
opening bracket to avoid links:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\[foo]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that this is a link, because a link label ends with the first
following closing bracket:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo*]:␣/url

*[foo*]
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;*&lt;a␣href=&quot;/url&quot;&gt;foo*&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Full references take precedence over shortcut references:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][bar]

[foo]:␣/url1
[bar]:␣/url2
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url2&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">In the following case </span><span class="code">`[bar][baz]`</span><span class="string"> is parsed as a reference,
</span><span class="code">`[foo]`</span><span class="string"> as normal text:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][bar][baz]

[baz]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo]&lt;a␣href=&quot;/url&quot;&gt;bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here, though, </span><span class="code">`[foo][bar]`</span><span class="string"> is parsed as a reference, since
</span><span class="code">`[bar]`</span><span class="string"> is defined:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][bar][baz]

[baz]:␣/url1
[bar]:␣/url2
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;/url2&quot;&gt;foo&lt;/a&gt;&lt;a␣href=&quot;/url1&quot;&gt;baz&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Here </span><span class="code">`[foo]`</span><span class="string"> is not parsed as a shortcut reference, because it
is followed by a link label (even though </span><span class="code">`[bar]`</span><span class="string"> is not defined):</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
[foo][bar][baz]

[baz]:␣/url1
[foo]:␣/url2
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;[foo]&lt;a␣href=&quot;/url1&quot;&gt;bar&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>

<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;images&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.6 Images</span></span>
</span>
<span class="paragraph"><span class="string">Syntax for images is like the syntax for links, with one
difference. Instead of </span><span class="link">[<span class="string">link text</span>]</span><span class="string">, we have an
</span><span class="link">[<span class="string">image description</span>](<span class="destination">@image-description</span>)</span><span class="string">.  The rules for this are the
same as for </span><span class="link">[<span class="string">link text</span>]</span><span class="string">, except that (a) an
image description starts with </span><span class="code">`![`</span><span class="string"> rather than </span><span class="code">`[`</span><span class="string">, and
(b) an image description may contain links.
An image description has inline elements
as its contents.  When an image is rendered to HTML,
this is standardly used as the image's </span><span class="code">`alt`</span><span class="string"> attribute.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo](/url␣&quot;title&quot;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;foo&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo␣*bar*]

[foo␣*bar*]:␣train.jpg␣&quot;train␣&amp;␣tracks&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;train.jpg&quot;␣alt=&quot;foo␣bar&quot;␣title=&quot;train␣&amp;amp;␣tracks&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo␣![bar](/url)](/url2)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url2&quot;␣alt=&quot;foo␣bar&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo␣[bar](/url)](/url2)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url2&quot;␣alt=&quot;foo␣bar&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Though this spec is concerned with parsing, not rendering, it is
recommended that in rendering to HTML, only the plain string content
of the </span><span class="link">[<span class="string">image description</span>]</span><span class="string"> be used.  Note that in
the above example, the alt attribute's value is </span><span class="code">`foo bar`</span><span class="string">, not </span><span class="code">`foo
[bar](/url)`</span><span class="string"> or </span><span class="code">`foo &lt;a href=&quot;/url&quot;&gt;bar&lt;/a&gt;`</span><span class="string">.  Only the plain string
content is rendered, without formatting.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo␣*bar*][]

[foo␣*bar*]:␣train.jpg␣&quot;train␣&amp;␣tracks&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;train.jpg&quot;␣alt=&quot;foo␣bar&quot;␣title=&quot;train␣&amp;amp;␣tracks&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo␣*bar*][foobar]

[FOOBAR]:␣train.jpg␣&quot;train␣&amp;␣tracks&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;train.jpg&quot;␣alt=&quot;foo␣bar&quot;␣title=&quot;train␣&amp;amp;␣tracks&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo](train.jpg)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;train.jpg&quot;␣alt=&quot;foo&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
My␣![foo␣bar](/path/to/train.jpg␣␣&quot;title&quot;␣␣␣)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;My␣&lt;img␣src=&quot;/path/to/train.jpg&quot;␣alt=&quot;foo␣bar&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo](&lt;url&gt;)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;url&quot;␣alt=&quot;foo&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![](/url)
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Reference-style:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo]␣[bar]

[bar]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;foo&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo]␣[bar]

[BAR]:␣/url
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;foo&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Collapsed:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo][]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;foo&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![*foo*␣bar][]

[*foo*␣bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;foo␣bar&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The labels are case-insensitive:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![Foo][]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;Foo&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">As with full reference links, </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> is allowed
between the two sets of brackets:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo]␣
[]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;foo&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Shortcut:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![foo]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;foo&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![*foo*␣bar]

[*foo*␣bar]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;foo␣bar&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Note that link labels cannot contain unescaped brackets:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![[foo]]

[[foo]]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;![[foo]]&lt;/p&gt;
&lt;p&gt;[[foo]]:␣/url␣&amp;quot;title&amp;quot;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">The link labels are case-insensitive:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
![Foo]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;img␣src=&quot;/url&quot;␣alt=&quot;Foo&quot;␣title=&quot;title&quot;␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If you just want bracketed text, you can backslash-escape the
opening </span><span class="code">`!`</span><span class="string"> and </span><span class="code">`[`</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\!\[foo]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;![foo]&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">If you want a link after a literal </span><span class="code">`!`</span><span class="string">, backslash-escape the
</span><span class="code">`!`</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
\![foo]

[foo]:␣/url␣&quot;title&quot;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;!&lt;a␣href=&quot;/url&quot;␣title=&quot;title&quot;&gt;foo&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;autolinks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.7 Autolinks</span></span>
</span>
<span class="paragraph"><span class="link">[<span class="string">Autolink</span>](<span class="destination">@autolink</span>)</span><span class="string">s are absolute URIs and email addresses inside
</span><span class="code">`&lt;`</span><span class="string"> and </span><span class="code">`&gt;`</span><span class="string">. They are parsed as links, with the URL or email address
as the link label.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">URI autolink</span>](<span class="destination">@uri-autolink</span>)</span><span class="string"> consists of </span><span class="code">`&lt;`</span><span class="string">, followed by an
</span><span class="link">[<span class="string">absolute URI</span>]</span><span class="string"> not containing </span><span class="code">`&lt;`</span><span class="string">, followed by </span><span class="code">`&gt;`</span><span class="string">.  It is parsed as
a link to the URI, with the URI as the link's label.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">absolute URI</span>](<span class="destination">@absolute-uri</span>)</span><span class="string">,
for these purposes, consists of a [<span class="string">scheme</span>] followed by a colon (</span><span class="code">`:`</span><span class="string">)
followed by zero or more characters other than ASCII
</span><span class="link">[<span class="string">whitespace</span>]</span><span class="string"> and control characters, </span><span class="code">`&lt;`</span><span class="string">, and </span><span class="code">`&gt;`</span><span class="string">.  If
the URI includes these characters, you must use percent-encoding
(e.g. </span><span class="code">`%20`</span><span class="string"> for a space).</span>
</span>
<span class="paragraph"><span class="string">The following </span><span class="link">[<span class="string">schemes</span>](<span class="destination">@scheme</span>)</span><span class="string">
are recognized (case-insensitive):
</span><span class="code">`coap`</span><span class="string">, </span><span class="code">`doi`</span><span class="string">, </span><span class="code">`javascript`</span><span class="string">, </span><span class="code">`aaa`</span><span class="string">, </span><span class="code">`aaas`</span><span class="string">, </span><span class="code">`about`</span><span class="string">, </span><span class="code">`acap`</span><span class="string">, </span><span class="code">`cap`</span><span class="string">,
</span><span class="code">`cid`</span><span class="string">, </span><span class="code">`crid`</span><span class="string">, </span><span class="code">`data`</span><span class="string">, </span><span class="code">`dav`</span><span class="string">, </span><span class="code">`dict`</span><span class="string">, </span><span class="code">`dns`</span><span class="string">, </span><span class="code">`file`</span><span class="string">, </span><span class="code">`ftp`</span><span class="string">, </span><span class="code">`geo`</span><span class="string">, </span><span class="code">`go`</span><span class="string">,
</span><span class="code">`gopher`</span><span class="string">, </span><span class="code">`h323`</span><span class="string">, </span><span class="code">`http`</span><span class="string">, </span><span class="code">`https`</span><span class="string">, </span><span class="code">`iax`</span><span class="string">, </span><span class="code">`icap`</span><span class="string">, </span><span class="code">`im`</span><span class="string">, </span><span class="code">`imap`</span><span class="string">, </span><span class="code">`info`</span><span class="string">,
</span><span class="code">`ipp`</span><span class="string">, </span><span class="code">`iris`</span><span class="string">, </span><span class="code">`iris.beep`</span><span class="string">, </span><span class="code">`iris.xpc`</span><span class="string">, </span><span class="code">`iris.xpcs`</span><span class="string">, </span><span class="code">`iris.lwz`</span><span class="string">, </span><span class="code">`ldap`</span><span class="string">,
</span><span class="code">`mailto`</span><span class="string">, </span><span class="code">`mid`</span><span class="string">, </span><span class="code">`msrp`</span><span class="string">, </span><span class="code">`msrps`</span><span class="string">, </span><span class="code">`mtqp`</span><span class="string">, </span><span class="code">`mupdate`</span><span class="string">, </span><span class="code">`news`</span><span class="string">, </span><span class="code">`nfs`</span><span class="string">,
</span><span class="code">`ni`</span><span class="string">, </span><span class="code">`nih`</span><span class="string">, </span><span class="code">`nntp`</span><span class="string">, </span><span class="code">`opaquelocktoken`</span><span class="string">, </span><span class="code">`pop`</span><span class="string">, </span><span class="code">`pres`</span><span class="string">, </span><span class="code">`rtsp`</span><span class="string">,
</span><span class="code">`service`</span><span class="string">, </span><span class="code">`session`</span><span class="string">, </span><span class="code">`shttp`</span><span class="string">, </span><span class="code">`sieve`</span><span class="string">, </span><span class="code">`sip`</span><span class="string">, </span><span class="code">`sips`</span><span class="string">, </span><span class="code">`sms`</span><span class="string">, </span><span class="code">`snmp`</span><span class="string">,</span><span class="code">`
soap.beep`</span><span class="string">, </span><span class="code">`soap.beeps`</span><span class="string">, </span><span class="code">`tag`</span><span class="string">, </span><span class="code">`tel`</span><span class="string">, </span><span class="code">`telnet`</span><span class="string">, </span><span class="code">`tftp`</span><span class="string">, </span><span class="code">`thismessage`</span><span class="string">,
</span><span class="code">`tn3270`</span><span class="string">, </span><span class="code">`tip`</span><span class="string">, </span><span class="code">`tv`</span><span class="string">, </span><span class="code">`urn`</span><span class="string">, </span><span class="code">`vemmi`</span><span class="string">, </span><span class="code">`ws`</span><span class="string">, </span><span class="code">`wss`</span><span class="string">, </span><span class="code">`xcon`</span><span class="string">,
</span><span class="code">`xcon-userid`</span><span class="string">, </span><span class="code">`xmlrpc.beep`</span><span class="string">, </span><span class="code">`xmlrpc.beeps`</span><span class="string">, </span><span class="code">`xmpp`</span><span class="string">, </span><span class="code">`z39.50r`</span><span class="string">,
</span><span class="code">`z39.50s`</span><span class="string">, </span><span class="code">`adiumxtra`</span><span class="string">, </span><span class="code">`afp`</span><span class="string">, </span><span class="code">`afs`</span><span class="string">, </span><span class="code">`aim`</span><span class="string">, </span><span class="code">`apt`</span><span class="string">,</span><span class="code">` attachment`</span><span class="string">, </span><span class="code">`aw`</span><span class="string">,
</span><span class="code">`beshare`</span><span class="string">, </span><span class="code">`bitcoin`</span><span class="string">, </span><span class="code">`bolo`</span><span class="string">, </span><span class="code">`callto`</span><span class="string">, </span><span class="code">`chrome`</span><span class="string">,</span><span class="code">` chrome-extension`</span><span class="string">,
</span><span class="code">`com-eventbrite-attendee`</span><span class="string">, </span><span class="code">`content`</span><span class="string">, </span><span class="code">`cvs`</span><span class="string">,</span><span class="code">` dlna-playsingle`</span><span class="string">,
</span><span class="code">`dlna-playcontainer`</span><span class="string">, </span><span class="code">`dtn`</span><span class="string">, </span><span class="code">`dvb`</span><span class="string">, </span><span class="code">`ed2k`</span><span class="string">, </span><span class="code">`facetime`</span><span class="string">, </span><span class="code">`feed`</span><span class="string">,
</span><span class="code">`finger`</span><span class="string">, </span><span class="code">`fish`</span><span class="string">, </span><span class="code">`gg`</span><span class="string">, </span><span class="code">`git`</span><span class="string">, </span><span class="code">`gizmoproject`</span><span class="string">, </span><span class="code">`gtalk`</span><span class="string">, </span><span class="code">`hcp`</span><span class="string">, </span><span class="code">`icon`</span><span class="string">,
</span><span class="code">`ipn`</span><span class="string">, </span><span class="code">`irc`</span><span class="string">, </span><span class="code">`irc6`</span><span class="string">, </span><span class="code">`ircs`</span><span class="string">, </span><span class="code">`itms`</span><span class="string">, </span><span class="code">`jar`</span><span class="string">, </span><span class="code">`jms`</span><span class="string">, </span><span class="code">`keyparc`</span><span class="string">, </span><span class="code">`lastfm`</span><span class="string">,
</span><span class="code">`ldaps`</span><span class="string">, </span><span class="code">`magnet`</span><span class="string">, </span><span class="code">`maps`</span><span class="string">, </span><span class="code">`market`</span><span class="string">,</span><span class="code">` message`</span><span class="string">, </span><span class="code">`mms`</span><span class="string">, </span><span class="code">`ms-help`</span><span class="string">,
</span><span class="code">`msnim`</span><span class="string">, </span><span class="code">`mumble`</span><span class="string">, </span><span class="code">`mvn`</span><span class="string">, </span><span class="code">`notes`</span><span class="string">, </span><span class="code">`oid`</span><span class="string">, </span><span class="code">`palm`</span><span class="string">, </span><span class="code">`paparazzi`</span><span class="string">,
</span><span class="code">`platform`</span><span class="string">, </span><span class="code">`proxy`</span><span class="string">, </span><span class="code">`psyc`</span><span class="string">, </span><span class="code">`query`</span><span class="string">, </span><span class="code">`res`</span><span class="string">, </span><span class="code">`resource`</span><span class="string">, </span><span class="code">`rmi`</span><span class="string">, </span><span class="code">`rsync`</span><span class="string">,
</span><span class="code">`rtmp`</span><span class="string">, </span><span class="code">`secondlife`</span><span class="string">, </span><span class="code">`sftp`</span><span class="string">, </span><span class="code">`sgn`</span><span class="string">, </span><span class="code">`skype`</span><span class="string">, </span><span class="code">`smb`</span><span class="string">, </span><span class="code">`soldat`</span><span class="string">,
</span><span class="code">`spotify`</span><span class="string">, </span><span class="code">`ssh`</span><span class="string">, </span><span class="code">`steam`</span><span class="string">, </span><span class="code">`svn`</span><span class="string">, </span><span class="code">`teamspeak`</span><span class="string">, </span><span class="code">`things`</span><span class="string">, </span><span class="code">`udp`</span><span class="string">,
</span><span class="code">`unreal`</span><span class="string">, </span><span class="code">`ut2004`</span><span class="string">, </span><span class="code">`ventrilo`</span><span class="string">, </span><span class="code">`view-source`</span><span class="string">, </span><span class="code">`webcal`</span><span class="string">, </span><span class="code">`wtai`</span><span class="string">,
</span><span class="code">`wyciwyg`</span><span class="string">, </span><span class="code">`xfire`</span><span class="string">, </span><span class="code">`xri`</span><span class="string">, </span><span class="code">`ymsgr`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">Here are some valid autolinks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;http://foo.bar.baz&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;http://foo.bar.baz&quot;&gt;http://foo.bar.baz&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;http://foo.bar.baz?q=hello&amp;id=22&amp;boolean&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;http://foo.bar.baz?q=hello&amp;amp;id=22&amp;amp;boolean&quot;&gt;http://foo.bar.baz?q=hello&amp;amp;id=22&amp;amp;boolean&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;irc://foo.bar:2233/baz&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;irc://foo.bar:2233/baz&quot;&gt;irc://foo.bar:2233/baz&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Uppercase is also fine:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;MAILTO:FOO@BAR.BAZ&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;MAILTO:FOO@BAR.BAZ&quot;&gt;MAILTO:FOO@BAR.BAZ&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Spaces are not allowed in autolinks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;http://foo.bar/baz␣bim&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;http://foo.bar/baz␣bim&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">email autolink</span>](<span class="destination">@email-autolink</span>)</span><span class="string">
consists of </span><span class="code">`&lt;`</span><span class="string">, followed by an </span><span class="link">[<span class="string">email address</span>]</span><span class="string">,
followed by </span><span class="code">`&gt;`</span><span class="string">.  The link's label is the email address,
and the URL is </span><span class="code">`mailto:`</span><span class="string"> followed by the email address.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">email address</span>](<span class="destination">@email-address</span>)</span><span class="string">,
for these purposes, is anything that matches
the </span><span class="link">[<span class="string">non-normative regex from the HTML5
spec</span>](<span class="destination">https://html.spec.whatwg.org/multipage/forms.html#e-mail-state-(type=email)</span>)</span><span class="string">:</span>
</span>
<span class="indented code block">    /^[a-zA-Z0-9.!#$%&amp;'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?
    (?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/

</span><span class="paragraph"><span class="string">Examples of email autolinks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;foo@bar.example.com&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;mailto:foo@bar.example.com&quot;&gt;foo@bar.example.com&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;foo+special@Bar.baz-bar0.com&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;mailto:foo+special@Bar.baz-bar0.com&quot;&gt;foo+special@Bar.baz-bar0.com&lt;/a&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">These are not autolinks:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;heck://bing.bong&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;heck://bing.bong&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;␣http://foo.bar␣&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;␣http://foo.bar␣&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;foo.bar.baz&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;foo.bar.baz&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;localhost:5001/foo&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;localhost:5001/foo&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
http://example.com
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;http://example.com&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo@bar.example.com
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo@bar.example.com&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;raw-html&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.8 Raw HTML</span></span>
</span>
<span class="paragraph"><span class="string">Text between </span><span class="code">`&lt;`</span><span class="string"> and </span><span class="code">`&gt;`</span><span class="string"> that looks like an HTML tag is parsed as a
raw HTML tag and will be rendered in HTML without escaping.
Tag and attribute names are not limited to current HTML tags,
so custom tags (and even, say, DocBook tags) may be used.</span>
</span>
<span class="paragraph"><span class="string">Here is the grammar for tags:</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">tag name</span>](<span class="destination">@tag-name</span>)</span><span class="string"> consists of an ASCII letter
followed by zero or more ASCII letters or digits.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">attribute</span>](<span class="destination">@attribute</span>)</span><span class="string"> consists of </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">,
an </span><span class="link">[<span class="string">attribute name</span>]</span><span class="string">, and an optional
</span><span class="link">[<span class="string">attribute value specification</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">attribute name</span>](<span class="destination">@attribute-name</span>)</span><span class="string">
consists of an ASCII letter, </span><span class="code">`_`</span><span class="string">, or </span><span class="code">`:`</span><span class="string">, followed by zero or more ASCII
letters, digits, </span><span class="code">`_`</span><span class="string">, </span><span class="code">`.`</span><span class="string">, </span><span class="code">`:`</span><span class="string">, or </span><span class="code">`-`</span><span class="string">.  (Note:  This is the XML
specification restricted to ASCII.  HTML5 is laxer.)</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">attribute value specification</span>](<span class="destination">@attribute-value-specification</span>)</span><span class="string">
consists of optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">,
a </span><span class="code">`=`</span><span class="string"> character, optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, and an </span><span class="link">[<span class="string">attribute
value</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">attribute value</span>](<span class="destination">@attribute-value</span>)</span><span class="string">
consists of an </span><span class="link">[<span class="string">unquoted attribute value</span>]</span><span class="string">,
a </span><span class="link">[<span class="string">single-quoted attribute value</span>]</span><span class="string">, or a </span><span class="link">[<span class="string">double-quoted attribute value</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">unquoted attribute value</span>](<span class="destination">@unquoted-attribute-value</span>)</span><span class="string">
is a nonempty string of characters not
including spaces, </span><span class="code">`&quot;`</span><span class="string">, </span><span class="code">`'`</span><span class="string">, </span><span class="code">`=`</span><span class="string">, </span><span class="code">`&lt;`</span><span class="string">, </span><span class="code">`&gt;`</span><span class="string">, or </span><span class="code">`` ` ``</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">single-quoted attribute value</span>](<span class="destination">@single-quoted-attribute-value</span>)</span><span class="string">
consists of </span><span class="code">`'`</span><span class="string">, zero or more
characters not including </span><span class="code">`'`</span><span class="string">, and a final </span><span class="code">`'`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">double-quoted attribute value</span>](<span class="destination">@double-quoted-attribute-value</span>)</span><span class="string">
consists of </span><span class="code">`&quot;`</span><span class="string">, zero or more
characters not including </span><span class="code">`&quot;`</span><span class="string">, and a final </span><span class="code">`&quot;`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">open tag</span>](<span class="destination">@open-tag</span>)</span><span class="string"> consists of a </span><span class="code">`&lt;`</span><span class="string"> character, a </span><span class="link">[<span class="string">tag name</span>]</span><span class="string">,
zero or more [<span class="string">attributes</span>], optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, an optional </span><span class="code">`/`</span><span class="string">
character, and a </span><span class="code">`&gt;`</span><span class="string"> character.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">closing tag</span>](<span class="destination">@closing-tag</span>)</span><span class="string"> consists of the string </span><span class="code">`&lt;/`</span><span class="string">, a
</span><span class="link">[<span class="string">tag name</span>]</span><span class="string">, optional </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, and the character </span><span class="code">`&gt;`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">HTML comment</span>](<span class="destination">@html-comment</span>)</span><span class="string"> consists of </span><span class="code">`&lt;!--`</span><span class="string"> + </span><span class="emphasis">*<span class="string">text</span>*</span><span class="string"> + </span><span class="code">`--&gt;`</span><span class="string">,
where </span><span class="emphasis">*<span class="string">text</span>*</span><span class="string"> does not start with </span><span class="code">`&gt;`</span><span class="string"> or </span><span class="code">`-&gt;`</span><span class="string">, does not end with </span><span class="code">`-`</span><span class="string">,
and does not contain </span><span class="code">`--`</span><span class="string">.  (See the
</span><span class="link">[<span class="string">HTML5 spec</span>](<span class="destination">http://www.w3.org/TR/html5/syntax.html#comments</span>)</span><span class="string">.)</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">processing instruction</span>](<span class="destination">@processing-instruction</span>)</span><span class="string">
consists of the string </span><span class="code">`&lt;?`</span><span class="string">, a string
of characters not including the string </span><span class="code">`?&gt;`</span><span class="string">, and the string
</span><span class="code">`?&gt;`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">declaration</span>](<span class="destination">@declaration</span>)</span><span class="string"> consists of the
string </span><span class="code">`&lt;!`</span><span class="string">, a name consisting of one or more uppercase ASCII letters,
</span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">, a string of characters not including the
character </span><span class="code">`&gt;`</span><span class="string">, and the character </span><span class="code">`&gt;`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">A </span><span class="link">[<span class="string">CDATA section</span>](<span class="destination">@cdata-section</span>)</span><span class="string"> consists of
the string </span><span class="code">`&lt;![CDATA[`</span><span class="string">, a string of characters not including the string
</span><span class="code">`]]&gt;`</span><span class="string">, and the string </span><span class="code">`]]&gt;`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">An </span><span class="link">[<span class="string">HTML tag</span>](<span class="destination">@html-tag</span>)</span><span class="string"> consists of an </span><span class="link">[<span class="string">open tag</span>]</span><span class="string">, a </span><span class="link">[<span class="string">closing tag</span>]</span><span class="string">,
an </span><span class="link">[<span class="string">HTML comment</span>]</span><span class="string">, a </span><span class="link">[<span class="string">processing instruction</span>]</span><span class="string">, a </span><span class="link">[<span class="string">declaration</span>]</span><span class="string">,
or a </span><span class="link">[<span class="string">CDATA section</span>]</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">Here are some simple open tags:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a&gt;&lt;bab&gt;&lt;c2c&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a&gt;&lt;bab&gt;&lt;c2c&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Empty elements:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a/&gt;&lt;b2/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a/&gt;&lt;b2/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="link">[<span class="string">Whitespace</span>]</span><span class="string"> is allowed:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣␣/&gt;&lt;b2
data=&quot;foo&quot;␣&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣␣/&gt;&lt;b2
data=&quot;foo&quot;␣&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">With attributes:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣foo=&quot;bar&quot;␣bam␣=␣'baz␣&lt;em&gt;&quot;&lt;/em&gt;'
_boolean␣zoop:33=zoop:33␣/&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣foo=&quot;bar&quot;␣bam␣=␣'baz␣&lt;em&gt;&quot;&lt;/em&gt;'
_boolean␣zoop:33=zoop:33␣/&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Illegal tag names, not parsed as HTML:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;33&gt;␣&lt;__&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;33&amp;gt;␣&amp;lt;__&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Illegal attribute names:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣h*#ref=&quot;hi&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;a␣h*#ref=&amp;quot;hi&amp;quot;&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Illegal attribute values:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;hi'&gt;␣&lt;a␣href=hi'&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;a␣href=&amp;quot;hi'&amp;gt;␣&amp;lt;a␣href=hi'&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Illegal </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;␣a&gt;&lt;
foo&gt;&lt;bar/␣&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;␣a&amp;gt;&amp;lt;
foo&amp;gt;&amp;lt;bar/␣&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Missing </span><span class="link">[<span class="string">whitespace</span>]</span><span class="string">:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href='bar'title=title&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;a␣href='bar'title=title&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Closing tags:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;/a&gt;
&lt;/foo␣&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;/a&gt;
&lt;/foo␣&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Illegal attributes in closing tag:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;/a␣href=&quot;foo&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;/a␣href=&amp;quot;foo&amp;quot;&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Comments:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣&lt;!--␣this␣is␣a
comment␣-␣with␣hyphen␣--&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;!--␣this␣is␣a
comment␣-␣with␣hyphen␣--&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣&lt;!--␣not␣a␣comment␣--␣two␣hyphens␣--&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&amp;lt;!--␣not␣a␣comment␣--␣two␣hyphens␣--&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Not comments:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣&lt;!--&gt;␣foo␣--&gt;

foo␣&lt;!--␣foo---&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&amp;lt;!--&amp;gt;␣foo␣--&amp;gt;&lt;/p&gt;
&lt;p&gt;foo␣&amp;lt;!--␣foo---&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Processing instructions:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣&lt;?php␣echo␣$a;␣?&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;?php␣echo␣$a;␣?&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Declarations:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣&lt;!ELEMENT␣br␣EMPTY&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;!ELEMENT␣br␣EMPTY&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">CDATA sections:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣&lt;![CDATA[&gt;&amp;&lt;]]&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo␣&lt;![CDATA[&gt;&amp;&lt;]]&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Entities are preserved in HTML attributes:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;&amp;ouml;&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;&amp;ouml;&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Backslash escapes do not work in HTML attributes:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;\*&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;\*&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;\&quot;&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&amp;lt;a␣href=&amp;quot;&amp;quot;&amp;quot;&amp;gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;hard-line-breaks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.9 Hard line breaks</span></span>
</span>
<span class="paragraph"><span class="string">A line break (not in a code span or HTML tag) that is preceded
by two or more spaces and does not occur at the end of a block
is parsed as a </span><span class="link">[<span class="string">hard line break</span>](<span class="destination">@hard-line-break</span>)</span><span class="string"> (rendered
in HTML as a </span><span class="code">`&lt;br /&gt;`</span><span class="string"> tag):</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣␣
baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;br␣/&gt;
baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">For a more visible alternative, a backslash before the
</span><span class="link">[<span class="string">line ending</span>]</span><span class="string"> may be used instead of two spaces:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo\
baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;br␣/&gt;
baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">More than two spaces can be used:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣␣␣␣␣␣␣
baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;br␣/&gt;
baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Leading spaces at the beginning of the next line are ignored:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣␣
␣␣␣␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;br␣/&gt;
bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo\
␣␣␣␣␣bar
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;br␣/&gt;
bar&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Line breaks can occur inside emphasis, links, and other constructs
that allow inline content:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo␣␣
bar*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;br␣/&gt;
bar&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
*foo\
bar*
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;em&gt;foo&lt;br␣/&gt;
bar&lt;/em&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Line breaks do not occur inside code spans</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`code␣␣
span`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;code␣span&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
`code\
span`
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;code&gt;code\␣span&lt;/code&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">or HTML tags:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;foo␣␣
bar&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;foo␣␣
bar&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
&lt;a␣href=&quot;foo\
bar&quot;&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;&lt;a␣href=&quot;foo\
bar&quot;&gt;&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Hard line breaks are for separating inline content within a block.
Neither syntax for hard line breaks works at the end of a paragraph or
other block element:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo\
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo\&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
###␣foo\
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h3&gt;foo\&lt;/h3&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
###␣foo␣␣
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;h3&gt;foo&lt;/h3&gt;
`````````````````````````````````````````````````````````
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;soft-line-breaks&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.10 Soft line breaks</span></span>
</span>
<span class="paragraph"><span class="string">A regular line break (not in a code span or HTML tag) that is not
preceded by two or more spaces is parsed as a softbreak.  (A
softbreak may be rendered in HTML either as a
</span><span class="link">[<span class="string">line ending</span>]</span><span class="string"> or as a space. The result will be the same
in browsers. In the examples here, a </span><span class="link">[<span class="string">line ending</span>]</span><span class="string"> will be used.)</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo
baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo
baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Spaces at the end of the line and beginning of the next line are
removed:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
foo␣
␣baz
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;foo
baz&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">A conforming parser may render a soft line break in HTML either as a
line break or as a space.</span>
</span>
<span class="paragraph"><span class="string">A renderer may also provide an option to render soft line breaks
as hard line breaks.</span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;textual-content&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> 6.11 Textual content</span></span>
</span>
<span class="paragraph"><span class="string">Any characters not given an interpretation by the above rules will
be parsed as plain textual content.</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
hello␣$.;'there
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;hello␣$.;'there&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Foo␣χρῆν
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Foo␣χρῆν&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="paragraph"><span class="string">Internal spaces are preserved verbatim:</span>
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` markdown
Multiple␣␣␣␣␣spaces
`````````````````````````````````````````````````````````
</span>
<span class="fenced code block">````````````````````````````````````````````````````````` html
&lt;p&gt;Multiple␣␣␣␣␣spaces&lt;/p&gt;
`````````````````````````````````````````````````````````
</span>
<span class="html block">&lt;!-- END TESTS --&gt;
</span>
<span class="atx header"># <span class="content"><span class="html">&lt;a id=&quot;appendix-a-a-parsing-strategy&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> Appendix A: A parsing strategy {-}</span></span>
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;overview&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> Overview {-}</span></span>
</span>
<span class="paragraph"><span class="string">Parsing has two phases:</span>
</span>
<span class="list"><span class="list item">1. <span class="content"><span class="paragraph"><span class="string">In the first phase, lines of input are consumed and the block
</span></span></span><span class="content"><span class="paragraph"><span class="string">structure of the document---its division into paragraphs, block quotes,
</span></span></span><span class="content"><span class="paragraph"><span class="string">list items, and so on---is constructed.  Text is assigned to these
</span></span></span><span class="content"><span class="paragraph"><span class="string">blocks but not parsed. Link reference definitions are parsed and a
</span></span></span><span class="content"><span class="paragraph"><span class="string">map of links is constructed.</span>
</span></span>
</span><span class="list item">2. <span class="content"><span class="paragraph"><span class="string">In the second phase, the raw text contents of paragraphs and headers
</span></span></span><span class="content"><span class="paragraph"><span class="string">are parsed into sequences of Markdown inline elements (strings,
</span></span></span><span class="content"><span class="paragraph"><span class="string">code spans, links, emphasis, and so on), using the map of link
</span></span></span><span class="content"><span class="paragraph"><span class="string">references constructed in phase 1.</span>
</span></span></span></span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;the-document-tree&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> The document tree {-}</span></span>
</span>
<span class="paragraph"><span class="string">At each point in processing, the document is represented as a tree of
</span><span class="emphasis">**<span class="string">blocks</span>**</span><span class="string">.  The root of the tree is a </span><span class="code">`document`</span><span class="string"> block.  The </span><span class="code">`document`</span><span class="string">
may have any number of other blocks as </span><span class="emphasis">**<span class="string">children</span>**</span><span class="string">.  These children
may, in turn, have other blocks as children.  The last child of a block
is normally considered </span><span class="emphasis">**<span class="string">open</span>**</span><span class="string">, meaning that subsequent lines of input
can alter its contents.  (Blocks that are not open are </span><span class="emphasis">**<span class="string">closed</span>**</span><span class="string">.)
Here, for example, is a possible document tree, with the open blocks
marked by arrows:</span>
</span>
<span class="fenced code block">``` tree
-&gt; document
  -&gt; block_quote
       paragraph
         &quot;Lorem ipsum dolor\nsit amet.&quot;
    -&gt; list (type=bullet tight=true bullet_char=-)
         list_item
           paragraph
             &quot;Qui *quodsi iracundia*&quot;
      -&gt; list_item
        -&gt; paragraph
             &quot;aliquando id&quot;
```
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;how-source-lines-alter-the-document-tree&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> How source lines alter the document tree {-}</span></span>
</span>
<span class="paragraph"><span class="string">Each line that is processed has an effect on this tree.  The line is
analyzed and, depending on its contents, the document may be altered
in one or more of the following ways:</span>
</span>
<span class="list"><span class="list item">1. <span class="content"><span class="paragraph"><span class="string">One or more open blocks may be closed.</span>
</span></span></span><span class="list item">2. <span class="content"><span class="paragraph"><span class="string">One or more new blocks may be created as children of the
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">last open block.</span>
</span></span></span><span class="list item">3. <span class="content"><span class="paragraph"><span class="string">Text may be added to the last (deepest) open block remaining
</span></span></span>   <span class="content"><span class="paragraph"><span class="string">on the tree.</span>
</span></span></span></span>
<span class="paragraph"><span class="string">Once a line has been incorporated into the tree in this way,
it can be discarded, so input can be read in a stream.</span>
</span>
<span class="paragraph"><span class="string">We can see how this works by considering how the tree above is
generated by four lines of Markdown:</span>
</span>
<span class="fenced code block">``` markdown
&gt; Lorem ipsum dolor
sit amet.
&gt; - Qui *quodsi iracundia*
&gt; - aliquando id
```
</span>
<span class="paragraph"><span class="string">At the outset, our document model is just</span>
</span>
<span class="fenced code block">``` tree
-&gt; document
```
</span>
<span class="paragraph"><span class="string">The first line of our text,</span>
</span>
<span class="fenced code block">``` markdown
&gt; Lorem ipsum dolor
```
</span>
<span class="paragraph"><span class="string">causes a </span><span class="code">`block_quote`</span><span class="string"> block to be created as a child of our
open </span><span class="code">`document`</span><span class="string"> block, and a </span><span class="code">`paragraph`</span><span class="string"> block as a child of
the </span><span class="code">`block_quote`</span><span class="string">.  Then the text is added to the last open
block, the </span><span class="code">`paragraph`</span><span class="string">:</span>
</span>
<span class="fenced code block">``` tree
-&gt; document
  -&gt; block_quote
    -&gt; paragraph
         &quot;Lorem ipsum dolor&quot;
```
</span>
<span class="paragraph"><span class="string">The next line,</span>
</span>
<span class="fenced code block">``` markdown
sit amet.
```
</span>
<span class="paragraph"><span class="string">is a &quot;lazy continuation&quot; of the open </span><span class="code">`paragraph`</span><span class="string">, so it gets added
to the paragraph's text:</span>
</span>
<span class="fenced code block">``` tree
-&gt; document
  -&gt; block_quote
    -&gt; paragraph
         &quot;Lorem ipsum dolor\nsit amet.&quot;
```
</span>
<span class="paragraph"><span class="string">The third line,</span>
</span>
<span class="fenced code block">``` markdown
&gt; - Qui *quodsi iracundia*
```
</span>
<span class="paragraph"><span class="string">causes the </span><span class="code">`paragraph`</span><span class="string"> block to be closed, and a new </span><span class="code">`list`</span><span class="string"> block
opened as a child of the </span><span class="code">`block_quote`</span><span class="string">.  A </span><span class="code">`list_item`</span><span class="string"> is also
added as a child of the </span><span class="code">`list`</span><span class="string">, and a </span><span class="code">`paragraph`</span><span class="string"> as a child of
the </span><span class="code">`list_item`</span><span class="string">.  The text is then added to the new </span><span class="code">`paragraph`</span><span class="string">:</span>
</span>
<span class="fenced code block">``` tree
-&gt; document
  -&gt; block_quote
       paragraph
         &quot;Lorem ipsum dolor\nsit amet.&quot;
    -&gt; list (type=bullet tight=true bullet_char=-)
      -&gt; list_item
        -&gt; paragraph
             &quot;Qui *quodsi iracundia*&quot;
```
</span>
<span class="paragraph"><span class="string">The fourth line,</span>
</span>
<span class="fenced code block">``` markdown
&gt; - aliquando id
```
</span>
<span class="paragraph"><span class="string">causes the </span><span class="code">`list_item`</span><span class="string"> (and its child the </span><span class="code">`paragraph`</span><span class="string">) to be closed,
and a new </span><span class="code">`list_item`</span><span class="string"> opened up as child of the </span><span class="code">`list`</span><span class="string">.  A </span><span class="code">`paragraph`</span><span class="string">
is added as a child of the new </span><span class="code">`list_item`</span><span class="string">, to contain the text.
We thus obtain the final tree:</span>
</span>
<span class="fenced code block">``` tree
-&gt; document
  -&gt; block_quote
       paragraph
         &quot;Lorem ipsum dolor\nsit amet.&quot;
    -&gt; list (type=bullet tight=true bullet_char=-)
         list_item
           paragraph
             &quot;Qui *quodsi iracundia*&quot;
      -&gt; list_item
        -&gt; paragraph
             &quot;aliquando id&quot;
```
</span>
<span class="atx header">## <span class="content"><span class="html">&lt;a id=&quot;from-block-structure-to-the-final-document&quot;&gt;</span><span class="html">&lt;/a&gt;</span><span class="string"> From block structure to the final document {-}</span></span>
</span>
<span class="paragraph"><span class="string">Once all of the input has been parsed, all open blocks are closed.</span>
</span>
<span class="paragraph"><span class="string">We then &quot;walk the tree,&quot; visiting every node, and parse raw
string contents of paragraphs and headers as inlines.  At this
point we have seen all the link reference definitions, so we can
resolve reference links as we go.</span>
</span>
<span class="fenced code block">``` tree
document
  block_quote
    paragraph
      str &quot;Lorem ipsum dolor&quot;
      softbreak
      str &quot;sit amet.&quot;
    list (type=bullet tight=true bullet_char=-)
      list_item
        paragraph
          str &quot;Qui &quot;
          emph
            str &quot;quodsi iracundia&quot;
      list_item
        paragraph
          str &quot;aliquando id&quot;
```
</span>
<span class="paragraph"><span class="string">Notice how the </span><span class="link">[<span class="string">line ending</span>]</span><span class="string"> in the first paragraph has
been parsed as a </span><span class="code">`softbreak`</span><span class="string">, and the asterisks in the first list item
have become an </span><span class="code">`emph`</span><span class="string">.</span>
</span>
<span class="paragraph"><span class="string">The document can be rendered as HTML, or in any other format, given
an appropriate renderer.</span>
</span>

[Introduction]: #introduction
[What is Markdown?]: #what-is-markdown-
[Why is a spec needed?]: #why-is-a-spec-needed-
[About this document]: #about-this-document
[Preliminaries]: #preliminaries
[Characters and lines]: #characters-and-lines
[character]: <span class="destination"><span class="destination">#character</span></span>
[line]: #line
[line ending]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#line-ending</span></span></span></span></span></span></span></span></span></span></span></span></span>
[blank line]: <span class="destination"><span class="destination"><span class="destination">#blank-line</span></span></span>
[whitespace character]: <span class="destination">#whitespace-character</span>
[Whitespace]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#whitespace</span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span>
[unicode whitespace character]: <span class="destination">#unicode-whitespace-character</span>
[Unicode whitespace]: <span class="destination"><span class="destination"><span class="destination"><span class="destination">#unicode-whitespace</span></span></span></span>
[non-space character]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#non-space-character</span></span></span></span></span></span></span></span></span></span></span></span>
[ASCII punctuation character]: <span class="destination">#ascii-punctuation-character</span>
[punctuation character]: <span class="destination"><span class="destination"><span class="destination"><span class="destination">#punctuation-character</span></span></span></span>
[Tab expansion]: #tab-expansion
[Blocks and inlines]: #blocks-and-inlines
[blocks]: #block
[inline]: #inline
[Precedence]: #precedence
[Container blocks and leaf blocks]: #container-blocks-and-leaf-blocks
[container block]: <span class="destination">#container-block</span>
[leaf block]: #leaf-block
[Leaf blocks]: #leaf-blocks
[Horizontal rules]: #horizontal-rules
[horizontal rule]: #horizontal-rule
[ATX headers]: #atx-headers
[ATX header]: #atx-header
[Setext headers]: #setext-headers
[setext header]: <span class="destination"><span class="destination">#setext-header</span></span>
[setext header underline]: <span class="destination"><span class="destination"><span class="destination">#setext-header-underline</span></span></span>
[Indented code blocks]: #indented-code-blocks
[indented code block]: #indented-code-block
[indented chunk]: <span class="destination">#indented-chunk</span>
[Fenced code blocks]: #fenced-code-blocks
[code fence]: <span class="destination">#code-fence</span>
[fenced code block]: <span class="destination"><span class="destination">#fenced-code-block</span></span>
[info string]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#info-string</span></span></span></span></span></span></span></span></span>
[HTML blocks]: #html-blocks
[HTML block tag]: <span class="destination">#html-block-tag</span>
[HTML block]: #html-block
[Link reference definitions]: <span class="destination">#link-reference-definitions</span>
[link reference definition]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#link-reference-definition</span></span></span></span></span></span></span></span>
[Paragraphs]: #paragraphs
[paragraph]: #paragraph
[Blank lines]: <span class="destination">#blank-lines</span>
[Container blocks]: #container-blocks
[Block quotes]: <span class="destination"><span class="destination"><span class="destination"><span class="destination">#block-quotes</span></span></span></span>
[block quote marker]: <span class="destination"><span class="destination"><span class="destination"><span class="destination">#block-quote-marker</span></span></span></span>
[Paragraph continuation text]: <span class="destination"><span class="destination">#paragraph-continuation-text</span></span>
[List items]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#list-items</span></span></span></span></span></span>
[list marker]: <span class="destination"><span class="destination"><span class="destination">#list-marker</span></span></span>
[bullet list marker]: <span class="destination"><span class="destination">#bullet-list-marker</span></span>
[ordered list marker]: <span class="destination"><span class="destination">#ordered-list-marker</span></span>
[lazy continuation line]: <span class="destination"><span class="destination">#lazy-continuation-line</span></span>
[Motivation]: #motivation
[Lists]: <span class="destination">#lists</span>
[list]: <span class="destination">#list</span>
[of the same type]: <span class="destination">#of-the-same-type</span>
[ordered list]: <span class="destination">#ordered-list</span>
[bullet list]: #bullet-list
[start number]: #start-number
[loose]: <span class="destination">#loose</span>
[tight]: <span class="destination">#tight</span>
[principle of uniformity]: <span class="destination">#principle-of-uniformity</span>
[Inlines]: #inlines
[Backslash escapes]: #backslash-escapes
[Entities]: #entities
[Named entities]: #name-entities
[Decimal entities]: #decimal-entities
[Hexadecimal entities]: #hexadecimal-entities
[Code spans]: #code-spans
[backtick string]: #backtick-string
[code span]: <span class="destination">#code-span</span>
[Emphasis and strong emphasis]: <span class="destination">#emphasis-and-strong-emphasis</span>
[delimiter run]: <span class="destination"><span class="destination">#delimiter-run</span></span>
[left-flanking delimiter run]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#left-flanking-delimiter-run</span></span></span></span></span></span></span></span></span>
[right-flanking delimiter run]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#right-flanking-delimiter-run</span></span></span></span></span></span></span>
[can open emphasis]: <span class="destination"><span class="destination">#can-open-emphasis</span></span>
[can close emphasis]: <span class="destination"><span class="destination"><span class="destination"><span class="destination">#can-close-emphasis</span></span></span></span>
[can open strong emphasis]: <span class="destination"><span class="destination">#can-open-strong-emphasis</span></span>
[can close strong emphasis]: <span class="destination"><span class="destination">#can-close-strong-emphasis</span></span>
[Links]: <span class="destination">#links</span>
[link text]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#link-text</span></span></span></span></span></span></span></span></span>
[link destination]: <span class="destination"><span class="destination"><span class="destination"><span class="destination">#link-destination</span></span></span></span>
[link title]: <span class="destination"><span class="destination"><span class="destination"><span class="destination">#link-title</span></span></span></span>
[inline link]: <span class="destination"><span class="destination">#inline-link</span></span>
[reference link]: <span class="destination"><span class="destination">#reference-link</span></span>
[full reference link]: <span class="destination">#full-reference-link</span>
[link label]: <span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination"><span class="destination">#link-label</span></span></span></span></span></span></span>
[matches]: <span class="destination"><span class="destination"><span class="destination"><span class="destination">#matches</span></span></span></span>
[collapsed reference link]: #collapsed-reference-link
[shortcut reference link]: <span class="destination">#shortcut-reference-link</span>
[Images]: <span class="destination">#images</span>
[image description]: <span class="destination">#image-description</span>
[Autolinks]: #autolinks
[Autolink]: <span class="destination">#autolink</span>
[URI autolink]: #uri-autolink
[absolute URI]: <span class="destination">#absolute-uri</span>
[schemes]: #scheme
[email autolink]: #email-autolink
[email address]: <span class="destination">#email-address</span>
[Raw HTML]: #raw-html
[tag name]: <span class="destination"><span class="destination">#tag-name</span></span>
[attribute]: #attribute
[attribute name]: <span class="destination">#attribute-name</span>
[attribute value specification]: <span class="destination">#attribute-value-specification</span>
[attribute value]: <span class="destination">#attribute-value</span>
[unquoted attribute value]: <span class="destination">#unquoted-attribute-value</span>
[single-quoted attribute value]: <span class="destination">#single-quoted-attribute-value</span>
[double-quoted attribute value]: <span class="destination">#double-quoted-attribute-value</span>
[open tag]: <span class="destination"><span class="destination">#open-tag</span></span>
[closing tag]: <span class="destination"><span class="destination">#closing-tag</span></span>
[HTML comment]: <span class="destination"><span class="destination">#html-comment</span></span>
[processing instruction]: <span class="destination"><span class="destination">#processing-instruction</span></span>
[declaration]: <span class="destination"><span class="destination">#declaration</span></span>
[CDATA section]: <span class="destination"><span class="destination">#cdata-section</span></span>
[HTML tag]: <span class="destination">#html-tag</span>
[Hard line breaks]: #hard-line-breaks
[hard line break]: <span class="destination"><span class="destination">#hard-line-break</span></span>
[Soft line breaks]: #soft-line-breaks
[Textual content]: #textual-content
[Appendix A: A parsing strategy]: #appendix-a-a-parsing-strategy
[Overview]: #overview
[The document tree]: #the-document-tree
[How source lines alter the document tree]: #how-source-lines-alter-the-document-tree
[From block structure to the final document]: #from-block-structure-to-the-final-document
</pre>
<script src="zepto.min.js"></script><script src="main.js"></script></body>
</html>
